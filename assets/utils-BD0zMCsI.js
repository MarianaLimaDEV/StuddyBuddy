import{s as at,g as Pt,a as Qt,r as Zt}from"./pwa-C1QSAv_I.js";const ut={intro:"/sfx/INTRO.mp3",open:"/sfx/OPEN.mp3",close:"/sfx/CLOSE.mp3",click:"/sfx/CLICK.mp3",interact:"/sfx/INTERACT.mp3",notification:"/sfx/NOTIFICATION.mp3",alarm:"/sfx/ALARM.mp3",reset:"/sfx/RESET.mp3",task_add:"/sfx/CLICK.mp3",task_delete:"/sfx/CLOSE.mp3",task_toggle:"/sfx/CLICK.mp3",mute_toggle:"/sfx/CLICK.mp3",login:"/sfx/OPEN.mp3",countdown_stop:"/sfx/RESET.mp3",timezone_add:"/sfx/OPEN.mp3",timezone_remove:"/sfx/CLOSE.mp3"},rt=new Map;let A=!0,Tt=!1;const mt="soundMuted";try{localStorage.getItem(mt)==="true"&&(A=!1)}catch{}function Q(){if(Tt)return;const t=new Audio("data:audio/wav;base64,UklGRigAAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQAAAAA=");t.volume=.01,t.play().then(()=>{Tt=!0,console.info("üîä Audio context unlocked"),t.pause()}).catch(e=>{console.warn("Could not unlock audio context:",e)})}document.addEventListener("click",Q,{once:!0});document.addEventListener("keydown",Q,{once:!0});document.addEventListener("touchstart",Q,{once:!0});function Jt(t){if(rt.has(t))return;const e=ut[t];if(!e){console.warn(`Sound "${t}" not found in sound mappings`);return}const o=new Audio(e);o.preload="auto",o.volume=.7,o.addEventListener("error",n=>{console.error(`‚ùå Failed to load sound "${t}" from "${e}":`,n),console.error("‚ùå Error details:",{code:o.error?.code,message:o.error?.message,MEDIA_ERR_ABORTED:1,MEDIA_ERR_NETWORK:2,MEDIA_ERR_DECODE:3,MEDIA_ERR_SRC_NOT_SUPPORTED:4})}),o.addEventListener("canplaythrough",()=>{}),o.addEventListener("loadstart",()=>{}),rt.set(t,o)}function te(){Object.keys(ut).forEach(t=>{Jt(t)})}function ye(){te(),console.info("üîä Sound manager initialized"),Q()}function y(t,{overlap:e=!1}={}){if(!A)return;const o=ut[t];if(!o){console.warn(`Sound "${t}" not configured`);return}const n=rt.get(t);if(n)if(e){const s=n.cloneNode();s.volume=n.volume||.7,s.play().then(()=>{}).catch(r=>{console.error(`Failed to play sound "${t}":`,r),et(t,o)})}else n.currentTime=0,n.volume=n.volume||.7,n.play().then(()=>console.debug(`Playing sound "${t}"`)).catch(s=>{console.error(`Failed to play sound "${t}":`,s),et(t,o)});else et(t,o)}function et(t,e){try{const o=new Audio(e);o.volume=.7,o.play().then(()=>{}).catch(n=>console.error(`Fallback play failed for "${t}":`,n))}catch(o){console.error(`Could not create audio for "${t}":`,o)}}function Ee(t){y(t,{overlap:!0})}function ve(){A=!A,console.info(`Sound ${A?"enabled":"disabled"}`);try{localStorage.setItem(mt,String(!A))}catch{}return!A}function be(){return!A}function Ae(t){A=!t;try{localStorage.setItem(mt,String(t))}catch{}}const xt="lang";let X=null;const ee={skipLink:{pt:"Saltar para o conte√∫do principal",en:"Skip to main content"},sidebarAria:{pt:"Estat√≠sticas e modo foco",en:"Stats and focus mode"},sidebarTabAria:{pt:"Abrir painel lateral",en:"Open side panel"},focusMode:{pt:"Modo foco",en:"Focus mode"},focusModeAria:{pt:"Ativar modo foco",en:"Activate focus mode"},focusModeExit:{pt:"Sair modo foco",en:"Exit focus mode"},focusModeExitAria:{pt:"Sair do modo foco",en:"Exit focus mode"},navAria:{pt:"Menu principal",en:"Main menu"},logoAria:{pt:"StuddyBuddy - P√°gina inicial",en:"StuddyBuddy - Home"},principal:{pt:"Principal",en:"Home"},principalText:{pt:"Bem-vindo ao StuddyBuddy! Acede √†s ferramentas clicando nos bot√µes abaixo: Pomodoro, Timer, Cron√≥metro, Task List, Countdown e World Clock. Podes abrir v√°rias ao mesmo tempo e arrast√°-las no ecr√£. Usa o modo foco para esconder a navega√ß√£o e concentrares-te no estudo.",en:"Welcome to StuddyBuddy! Access the tools by clicking the buttons below: Pomodoro, Timer, Stopwatch, Task List, Countdown and World Clock. You can open several at once and drag them on screen. Use focus mode to hide navigation and focus on studying."},sobre:{pt:"Sobre",en:"About"},sobreText:{pt:"O StuddyBuddy √© uma plataforma de estudo com ferramentas pr√°ticas: Pomodoro para sess√µes de foco, Timer, Cron√≥metro, lista de tarefas, contagem regressiva e rel√≥gio mundial. Faz login para sincronizar o teu tema e prefer√™ncias na nuvem.",en:"StuddyBuddy is a study platform with practical tools: Pomodoro for focus sessions, Timer, Stopwatch, task list, countdown and world clock. Log in to sync your theme and preferences in the cloud."},servicos:{pt:"Servi√ßos",en:"Services"},servicosText:{pt:"Pomodoro (trabalho/pausa), Timer personaliz√°vel, Cron√≥metro com voltas, Task List com backend, Countdown para datas importantes e World Clock com v√°rios fusos. Todas as ferramentas funcionam offline e podem ser instaladas como app (PWA).",en:"Pomodoro (work/break), customizable Timer, Stopwatch with laps, Task List with backend, Countdown for important dates and World Clock with multiple timezones. All tools work offline and can be installed as an app (PWA)."},configuracoes:{pt:"Configura√ß√µes",en:"Settings"},tema:{pt:"Tema",en:"Theme"},som:{pt:"Som",en:"Sound"},soundAria:{pt:"Ativar/desativar som",en:"Toggle sound"},faq:{pt:"FAQ",en:"FAQ"},faqAria:{pt:"Perguntas frequentes",en:"Frequently asked questions"},faq1Q:{pt:"Como fa√ßo login?",en:"How do I log in?"},faq1A:{pt:"Abre o menu <strong>Login</strong>, escreve o teu email e password, e confirma. Se ainda n√£o existir conta, o sistema cria automaticamente (exemplo fict√≠cio).",en:"Open the <strong>Login</strong> menu, enter your email and password, and confirm. If no account exists yet, the system creates one automatically (fictional example)."},faq2Q:{pt:"Como alterar o tema (claro/escuro)?",en:"How do I change the theme (light/dark)?"},faq2A:{pt:"Vai em <strong>Configura√ß√µes</strong> e muda o <strong>Tema</strong>. Ao estar conectado, o tema √© guardado para a pr√≥xima vez (texto fict√≠cio).",en:"Go to <strong>Settings</strong> and change the <strong>Theme</strong>. When connected, the theme is saved for next time (fictional text)."},faq3Q:{pt:"Como ativar/desativar o som?",en:"How do I enable/disable sound?"},faq3A:{pt:"Em <strong>Configura√ß√µes</strong>, clica no bot√£o de <strong>Som</strong>. Exemplo: ao desativar, o √≠cone muda e o estado fica guardado.",en:"In <strong>Settings</strong>, click the <strong>Sound</strong> button. Example: when disabled, the icon changes and the state is saved."},faq4Q:{pt:"Os meus dados ficam guardados?",en:"Is my data saved?"},faq4A:{pt:"Sim: as <strong>configura√ß√µes</strong> ficam associadas ao teu email (texto fict√≠cio). As ferramentas podem ter comportamentos diferentes dependendo do m√≥dulo.",en:"Yes: <strong>settings</strong> are associated with your email (fictional text). Tools may behave differently depending on the module."},faq5Q:{pt:"Posso abrir v√°rias ferramentas ao mesmo tempo?",en:"Can I open several tools at once?"},faq5A:{pt:"Sim. Podes abrir mais do que um card e organizar no ecr√£. Exemplo fict√≠cio: Pomodoro + TaskList lado a lado.",en:"Yes. You can open more than one card and arrange them on screen. Fictional example: Pomodoro + TaskList side by side."},faq6Q:{pt:"Perdi a password. E agora?",en:"I forgot my password. What now?"},faq6A:{pt:"Exemplo fict√≠cio: clica em <strong>Forgot password?</strong> e segue as instru√ß√µes. (Ainda pode ser uma funcionalidade futura.)",en:"Fictional example: click <strong>Forgot password?</strong> and follow the instructions. (May be a future feature.)"},shortcutsBtn:{pt:"‚å®Ô∏è Atalhos",en:"‚å®Ô∏è Shortcuts"},shortcutsAria:{pt:"Ver atalhos de teclado",en:"View keyboard shortcuts"},contacto:{pt:"Contacto",en:"Contact"},contactoText:{pt:"Entre em contacto!",en:"Get in touch!"},login:{pt:"Login",en:"Login"},navToggleAria:{pt:"Alternar menu de navega√ß√£o",en:"Toggle navigation menu"},dropdownClose:{pt:"Fechar",en:"Close"},pomodoro:{pt:"Pomodoro",en:"Pomodoro"},timer:{pt:"Timer",en:"Timer"},stopwatch:{pt:"Cron√≥metro",en:"Stopwatch"},tasklist:{pt:"TaskList",en:"TaskList"},countdown:{pt:"Countdown",en:"Countdown"},worldClock:{pt:"World Clock",en:"World Clock"},pomodoroTitle:{pt:"Pomodoro Timer",en:"Pomodoro Timer"},timerTitle:{pt:"Timer",en:"Timer"},stopwatchTitle:{pt:"Cron√≥metro",en:"Stopwatch"},tasklistTitle:{pt:"Task List",en:"Task List"},countdownTitle:{pt:"Countdown",en:"Countdown"},worldclockTitle:{pt:"World Clock",en:"World Clock"},workMin:{pt:"Tempo de trabalho em minutos",en:"Work time in minutes"},breakMin:{pt:"Tempo de pausa em minutos",en:"Break time in minutes"},start:{pt:"Start",en:"Start"},stop:{pt:"Stop",en:"Stop"},reset:{pt:"Reset",en:"Reset"},add:{pt:"Add",en:"Add"},lap:{pt:"Lap",en:"Lap"},taskPlaceholder:{pt:"Adicionar nova tarefa...",en:"Add a new task..."},taskLabel:{pt:"Nova tarefa",en:"New task"},addTaskAria:{pt:"Adicionar tarefa",en:"Add task"},countdownLabelPlaceholder:{pt:"T√≠tulo (opcional)",en:"Title (optional)"},countdownLabelAria:{pt:"Nome do countdown",en:"Countdown name"},countdownDateAria:{pt:"Data e hora de destino",en:"Target date and time"},addCountdownAria:{pt:"Adicionar countdown",en:"Add countdown"},resetCountdownAria:{pt:"Resetar todos os countdowns",en:"Reset all countdowns"},timezoneAria:{pt:"Selecionar fuso hor√°rio",en:"Select timezone"},addTimezoneAria:{pt:"Adicionar fuso hor√°rio",en:"Add timezone"},minutes:{pt:"Minutos",en:"Minutes"},seconds:{pt:"Segundos",en:"Seconds"},timeRemaining:{pt:"Tempo restante",en:"Time remaining"},elapsed:{pt:"Tempo decorrido",en:"Elapsed time"},closePomodoro:{pt:"Fechar Pomodoro Timer",en:"Close Pomodoro Timer"},closeTimer:{pt:"Fechar Timer",en:"Close Timer"},closeStopwatch:{pt:"Fechar Cron√≥metro",en:"Close Stopwatch"},closeTasklist:{pt:"Fechar Lista de Tarefas",en:"Close Task List"},closeCountdown:{pt:"Fechar Contagem Regressiva",en:"Close Countdown"},closeWorldclock:{pt:"Fechar Rel√≥gio Mundial",en:"Close World Clock"},entrar:{pt:"Entrar",en:"Log in"},criarConta:{pt:"Criar conta",en:"Create account"},loginSubtitle:{pt:"Acesse sua conta para sincronizar suas configura√ß√µes.",en:"Access your account to sync your settings."},rememberMe:{pt:"Lembrar-me",en:"Remember me"},forgotPassword:{pt:"Forgot password?",en:"Forgot password?"},confirmPassword:{pt:"Confirmar password",en:"Confirm password"},showPassword:{pt:"Mostrar",en:"Show"},showPasswordAria:{pt:"Mostrar password",en:"Show password"},hidePassword:{pt:"Ocultar",en:"Hide"},hidePasswordAria:{pt:"Ocultar password",en:"Hide password"},hidePasswordConfirmAria:{pt:"Ocultar confirma√ß√£o de password",en:"Hide password confirmation"},orContinue:{pt:"ou continuar com",en:"or continue with"},showPasswordConfirmAria:{pt:"Mostrar confirma√ß√£o de password",en:"Show password confirmation"},signUp:{pt:"Criar conta",en:"Sign up"},noAccount:{pt:"Don't have an account?",en:"Don't have an account?"},connected:{pt:"Conectado",en:"Connected"},connectedMsg:{pt:"Voc√™ est√° conectado!",en:"You're connected!"},ok:{pt:"Ok",en:"Ok"},signOut:{pt:"Sair",en:"Sign out"},closeLogin:{pt:"Fechar Login",en:"Close Login"},footer:{pt:"¬© 2026 StuddyBuddy. Desenvolvido por Mariana Lima.",en:"¬© 2026 StuddyBuddy. Developed by Mariana Lima."},cookies:{pt:"Cookies",en:"Cookies"},cookieText:{pt:"Usamos cookies essenciais para o funcionamento do site e cookies de prefer√™ncia para guardar op√ß√µes como tema e som.",en:"We use essential cookies for site functionality and preference cookies to save options like theme and sound."},accept:{pt:"Aceitar",en:"Accept"},reject:{pt:"Recusar",en:"Reject"},shortcutsTitle:{pt:"Atalhos de teclado",en:"Keyboard shortcuts"},shortcutsCloseAria:{pt:"Fechar",en:"Close"},shortcutStopwatch:{pt:"Cron√≥metro",en:"Stopwatch"},shortcutTheme:{pt:"Alternar tema",en:"Toggle theme"},shortcutShortcuts:{pt:"Ver atalhos",en:"View shortcuts"},shortcutCloseCards:{pt:"Fechar cards",en:"Close cards"},langLabel:{pt:"Idioma",en:"Language"},langBtn:{pt:"üåê PT",en:"üåê EN"},langBtnAria:{pt:"Mudar idioma para Ingl√™s",en:"Change language to Portuguese"},account:{pt:"Conta",en:"Account"},statsTitle:{pt:"Estat√≠sticas de estudo",en:"Study statistics"},statsToday:{pt:"Hoje:",en:"Today:"},statsWeek:{pt:"√öltimos 7 dias:",en:"Last 7 days:"},statsTotal:{pt:"Total:",en:"Total:"},statsSessions:{pt:"Sess√µes:",en:"Sessions:"},pomoBreakTitle:{pt:"Pausa!",en:"Break time!"},pomoBreakBody:{pt:"Tempo de descanso. Aproveita para cuidar de ti!",en:"Time to rest. Take care of yourself!"},pomoReminderWater:{pt:"üíß Bebe √°gua",en:"üíß Drink water"},pomoReminderStretch:{pt:"ü§∏ Alonga-te",en:"ü§∏ Stretch"},pomoReminderEat:{pt:"üçé Come algo saud√°vel",en:"üçé Eat something healthy"},pomoBreakWellness:{pt:"Pausa! Bebe √°gua ‚Ä¢ Alonga-te ‚Ä¢ Come algo saud√°vel",en:"Break! Drink water ‚Ä¢ Stretch ‚Ä¢ Eat something healthy"},pomoWorkTitle:{pt:"Tempo de trabalho!",en:"Work time!"},pomoWorkBody:{pt:"Mant√©m o foco!",en:"Stay focused!"},pomoWorkToast:{pt:"Hora de trabalhar! Mant√©m o foco!",en:"Work time! Stay focused!"}};function pt(){if(X==="en"||X==="pt")return X;try{const t=localStorage.getItem(xt);if(t==="en"||t==="pt")return t}catch{}return"pt"}function oe(t){if(!(t!=="pt"&&t!=="en")){X=t;try{localStorage.setItem(xt,t)}catch{}}}function m(t,e=pt()){const o=ee[t];return o?o[e]??o.pt??"":""}function it(){const t=pt();document.documentElement.lang=t==="pt"?"pt-PT":"en",document.querySelectorAll("[data-i18n]").forEach(o=>{const n=o.getAttribute("data-i18n");if(o.id==="loginButton"&&Dt()){const r=Ft(I());o.textContent=r==="Conta"?m("account"):r,o.setAttribute("aria-label",`${m("account")}: ${I()}`);return}const s=m(n);s&&o.tagName!=="INPUT"&&o.tagName!=="TEXTAREA"&&(/^faq\dA$/.test(n)?o.innerHTML=s:o.textContent=s)}),document.querySelectorAll("[data-i18n-placeholder]").forEach(o=>{const n=o.getAttribute("data-i18n-placeholder");o.placeholder=m(n)}),document.querySelectorAll("[data-i18n-aria]").forEach(o=>{const n=o.getAttribute("data-i18n-aria"),s=m(n);s&&o.setAttribute("aria-label",s)});const e=document.getElementById("langBtn");e&&(e.textContent=t==="pt"?"üåê EN":"üåê PT",e.setAttribute("aria-label",m("langBtnAria"))),document.dispatchEvent(new CustomEvent("i18n-changed",{detail:{lang:t}}))}function ne(){const t=pt()==="pt"?"en":"pt";oe(t),it()}function Se(){const t=document.getElementById("langBtn");t&&(t.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),ne()}),it(),document.addEventListener("login-success",it))}const Mt="studdybuddy_study_stats";function Ot(){try{const t=localStorage.getItem(Mt);if(!t)return{sessions:[],totalMinutes:0};const e=JSON.parse(t);return{sessions:e.sessions||[],totalMinutes:e.totalMinutes||0}}catch{return{sessions:[],totalMinutes:0}}}function se(t,e){try{localStorage.setItem(Mt,JSON.stringify({sessions:t,totalMinutes:e}))}catch{}}function ke(t){const{sessions:e,totalMinutes:o}=Ot(),n=new Date;e.push({date:n.toISOString().slice(0,10),minutes:t});const s=o+t;return se(e.slice(-500),s),window.dispatchEvent(new CustomEvent("studystats-updated")),s}function ot(t){if(t<60)return`${t} min`;const e=Math.floor(t/60),o=t%60;return o?`${e}h ${o}min`:`${e}h`}function ae(t){const e=document.getElementById(t);if(!e)return;const{sessions:o,totalMinutes:n}=Ot(),s=new Date().toISOString().slice(0,10),r=o.filter(c=>c.date===s).reduce((c,p)=>c+p.minutes,0),a=new Date;a.setDate(a.getDate()-7);const l=o.filter(c=>c.date>=a.toISOString().slice(0,10)).reduce((c,p)=>c+p.minutes,0);e.innerHTML=`
    <div class="stats-box">
      <h4 class="stats-title">${m("statsTitle")}</h4>
      <div class="stats-row">
        <span>${m("statsToday")}</span>
        <strong>${ot(r)}</strong>
      </div>
      <div class="stats-row">
        <span>${m("statsWeek")}</span>
        <strong>${ot(l)}</strong>
      </div>
      <div class="stats-row">
        <span>${m("statsTotal")}</span>
        <strong>${ot(n)}</strong>
      </div>
      <div class="stats-row">
        <span>${m("statsSessions")}</span>
        <strong>${o.length}</strong>
      </div>
    </div>
  `}const ct="authToken",dt="userEmail";function ft(){try{return localStorage.getItem(ct)}catch{return null}}function gt(t){try{t?localStorage.setItem(ct,t):localStorage.removeItem(ct)}catch{}}function I(){try{return localStorage.getItem(dt)}catch{return null}}function Ft(t){const e=String(t||"").trim();return e?e.split("@")[0]||e:"Conta"}function ht(t){try{t?localStorage.setItem(dt,t):localStorage.removeItem(dt)}catch{}}function Rt(){gt(null),ht(null)}function Dt(){return!!ft()}async function _t(t,e={}){const o=ft(),n=new Headers(e.headers||{});o&&n.set("Authorization",`Bearer ${o}`);const s=await fetch(t,{...e,headers:n});return s.status===401&&Rt(),s}async function re({email:t,password:e,rememberMe:o}){const n=String(t||"").trim().toLowerCase(),s=String(e||"");if(!n)throw new Error("Email √© obrigat√≥rio");if(!s)throw new Error("Password √© obrigat√≥ria");const r=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,password:s,rememberMe:!!o})});if(!r.ok){let l=`Erro HTTP ${r.status}`;try{const c=await r.json();c?.message&&(l=c.message)}catch{}throw new Error(l)}const a=await r.json();if(!a?.token)throw new Error("Resposta de login inv√°lida (token em falta)");return gt(a.token),ht(a?.user?.email||n),a}async function ie({email:t,password:e}){const o=String(t||"").trim().toLowerCase(),n=String(e||"");if(!o)throw new Error("Email √© obrigat√≥rio");if(!n||n.length<8)throw new Error("Password deve ter pelo menos 8 caracteres");const s=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:o,password:n})});if(!s.ok){let a=`Erro HTTP ${s.status}`;try{const l=await s.json();l?.message&&(a=l.message)}catch{}throw new Error(a)}const r=await s.json();if(!r?.token)throw new Error("Resposta de registo inv√°lida (token em falta)");return gt(r.token),ht(r?.user?.email||o),r}async function ce(t){const e=String(t||"").trim().toLowerCase();if(!e)throw new Error("Email √© obrigat√≥rio");const o=await fetch("/api/auth/forgot-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})});if(!o.ok){let n=`Erro HTTP ${o.status}`;try{const s=await o.json();s?.message&&(n=s.message)}catch{}throw new Error(n)}return await o.json()}async function de({token:t,password:e}){const o=String(t||"").trim(),n=String(e||"");if(!o)throw new Error("Token √© obrigat√≥rio");if(!n||n.length<8)throw new Error("Password deve ter pelo menos 8 caracteres");const s=await fetch("/api/auth/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:o,password:n})});if(!s.ok){let r=`Erro HTTP ${s.status}`;try{const a=await s.json();a?.message&&(r=a.message)}catch{}throw new Error(r)}return await s.json()}async function Ce(){const e=`userSettings:${I()||"anon"}`;try{const o=await _t("/api/user/settings");if(!o.ok){let s=`Erro HTTP ${o.status}`;try{const r=await o.json();r?.message&&(s=r.message)}catch{}throw new Error(s)}const n=await o.json();try{await at("dados",{_id:e,...n||{}})}catch(s){console.warn("Failed to cache user settings:",s)}return n}catch(o){const n=await Pt("dados",e).catch(()=>null);if(n){const{_id:s,...r}=n;return r}throw o}}async function le(t){const e=t||{};let o;try{o=await _t("/api/user/settings",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}catch{const c=`userSettings:${I()||"anon"}`,f={...await Pt("dados",c).catch(()=>null)||{},...e};try{await at("dados",{_id:c,...f})}catch(k){console.warn("Failed to save offline settings:",k)}const S=ft();if(S)try{await Qt({type:"PUT",url:"/api/user/settings",body:e,headers:{Authorization:`Bearer ${S}`}}),await Zt()}catch(k){console.warn("Failed to register background sync:",k)}return f}if(!o.ok){let a=`Erro HTTP ${o.status}`;try{const l=await o.json();l?.message&&(a=l.message)}catch{}throw new Error(a)}const n=await o.json(),r=`userSettings:${I()||"anon"}`;try{await at("dados",{_id:r,...n||{}})}catch(a){console.warn("Failed to cache user settings:",a)}return n}const lt="cookieConsent";function ue(){try{return localStorage.getItem(lt)}catch{return null}}function Lt(t){try{t?localStorage.setItem(lt,t):localStorage.removeItem(lt)}catch{}}function Te(){const t=document.getElementById("cookieBanner"),e=document.getElementById("cookieAccept"),o=document.getElementById("cookieReject");if(!t||!e||!o)return;const n=()=>{t.classList.remove("hidden"),t.setAttribute("aria-hidden","false"),e.focus()},s=()=>{t.classList.add("hidden"),t.setAttribute("aria-hidden","true")};ue()?s():n(),e.addEventListener("click",a=>{a.stopPropagation(),Lt("accepted"),s()}),o.addEventListener("click",a=>{a.stopPropagation(),Lt("rejected"),s()})}function Z(t){return t?Array.from(t.querySelectorAll(["a[href]","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])",'[tabindex]:not([tabindex="-1"])'].join(","))).filter(e=>{const o=window.getComputedStyle(e);return o.visibility!=="hidden"&&o.display!=="none"}):[]}function nt(t,e){t&&t.setAttribute("aria-expanded",e?"true":"false")}function h(t,e){t&&(e?(t.setAttribute("hidden",""),t.setAttribute("inert","")):(t.removeAttribute("hidden"),t.removeAttribute("inert")))}let Y=null,G=null;function Le(){Y&&document.removeEventListener("click",Y),Y=t=>{t.target.closest(".card-close")||t.target.closest(".dropdown-close")||t.target.closest(".login-popup-close")||t.target.closest("#muteToggle")||t.target.tagName==="INPUT"||t.target.tagName==="TEXTAREA"||t.target.tagName==="SELECT"||t.target.closest("input")||t.target.closest("textarea")||t.target.closest("select")||y("click")},document.addEventListener("click",Y,{passive:!0}),console.info("üîä Global click sound initialized (CLICK.mp3 on all clicks)")}function Ie(){G&&document.removeEventListener("focusin",G);const t=e=>{if(!e||e.disabled||e.readOnly)return!1;if(e.tagName==="TEXTAREA"||e.tagName==="SELECT")return!0;if(e.tagName!=="INPUT")return!1;const o=(e.getAttribute("type")||"text").toLowerCase();return!["checkbox","radio","button","submit","reset","range","color","file","hidden"].includes(o)};G=e=>{const o=e.target;t(o)&&y("interact")},document.addEventListener("focusin",G,{passive:!0}),console.info("üîä Global input focus sound initialized (INTERACT on focus)")}let L=null,Nt=0,qt=0,$t=0,Kt=0,$=!1;const It=5,zt=900,me=995;let D=zt;function st(t){t&&(D+=1,D>me&&(D=zt,Array.from(document.querySelectorAll(".card:not(.hidden)")).forEach(o=>{D+=1,o.style.zIndex=String(D)})),t.style.zIndex=String(D))}function Be(){document.querySelectorAll(".card").forEach(t=>{t.addEventListener("pointerdown",()=>st(t),{passive:!0}),t.addEventListener("focusin",()=>st(t),{passive:!0}),t.addEventListener("pointerdown",e=>{if(e.target.closest(".card-close")||e.target.closest("button")||e.target.tagName==="INPUT"||e.target.tagName==="TEXTAREA"||e.target.tagName==="SELECT"||e.target.closest("input")||e.target.closest("textarea")||e.target.closest("select"))return;const o=t.getBoundingClientRect(),n=28;if(!(e.clientX>=o.right-n&&e.clientY>=o.bottom-n)){if(L=t,st(t),Nt=e.clientX,qt=e.clientY,$t=t.offsetLeft,Kt=t.offsetTop,$=!1,e.preventDefault(),document.body.style.userSelect="none",e.pointerId&&t.setPointerCapture)try{t.setPointerCapture(e.pointerId)}catch{}document.addEventListener("pointermove",Wt),document.addEventListener("pointerup",jt)}})})}function Wt(t){if(!L)return;const e=t.clientX-Nt,o=t.clientY-qt;!$&&(Math.abs(e)>It||Math.abs(o)>It)&&($=!0),$&&(L.style.left=$t+e+"px",L.style.top=Kt+o+"px")}function jt(t){if(L){if(t.pointerId&&L.releasePointerCapture)try{L.releasePointerCapture(t.pointerId)}catch{}L=null,$=!1,document.removeEventListener("pointermove",Wt),document.removeEventListener("pointerup",jt),document.body.style.userSelect=""}}function Pe(){const t=document.querySelector(".navbar-toggle"),e=document.getElementById("navbar-menu")||document.querySelector(".navbar-menu");if(!t||!e)return;nt(t,!1),h(e,!0);const o=()=>{e.classList.add("open"),t.classList.add("is-open"),h(e,!1),nt(t,!0);const s=Z(e);s[0]&&s[0].focus()},n=()=>{e.classList.remove("open"),t.classList.remove("is-open"),h(e,!0),nt(t,!1),t.focus()};t.addEventListener("click",s=>{s.stopPropagation(),e.classList.contains("open")?n():o()}),document.addEventListener("click",s=>{!e.contains(s.target)&&!t.contains(s.target)&&e.classList.contains("open")&&n()}),document.addEventListener("keydown",s=>{s.key==="Escape"&&e.classList.contains("open")&&n()}),window.addEventListener("resize",()=>{window.innerWidth>=768&&e.classList.contains("open")&&n()})}function xe(t,e){const o=document.getElementById(t),n=document.getElementById(e);if(!o||!n)return;const s=!n.classList.contains("hidden");o.setAttribute("aria-pressed",s?"true":"false"),h(n,!s);const r=()=>{o.classList.add("pressed"),o.setAttribute("aria-pressed","true"),n.classList.remove("hidden"),h(n,!1),y("open");const c=n.querySelector(".card-close");if(c)c.focus();else{const p=Z(n);p[0]&&p[0].focus()}},a=({returnFocus:c=!0}={})=>{o.classList.remove("pressed"),o.setAttribute("aria-pressed","false"),n.classList.add("hidden"),h(n,!0),c&&o.focus()};o.addEventListener("click",()=>{!n.classList.contains("hidden")?a({returnFocus:!1}):r()});const l=n.querySelector(".card-close");l&&l.addEventListener("click",c=>{c.stopPropagation(),y("close"),a({returnFocus:!0})})}function Me(){const t=document.getElementById("loginButton"),e=document.getElementById("loginPopup"),o=document.getElementById("loginPopupClose"),n=document.getElementById("loginForm"),s=document.getElementById("loginFormView"),r=document.getElementById("resetPasswordView"),a=document.getElementById("resetBackBtn"),l=document.getElementById("resetPasswordForm"),c=document.getElementById("resetEmail"),p=document.getElementById("resetRequestBtn"),f=document.getElementById("resetToken"),S=document.getElementById("resetNewPassword"),k=document.getElementById("resetNewPasswordConfirm"),K=document.getElementById("resetSubmitBtn"),x=document.getElementById("loginConnectedView"),wt=document.getElementById("loginConnectedMessage"),z=document.getElementById("loginConnectedOk"),yt=document.getElementById("signOutBtn"),C=document.getElementById("loginPassword"),v=document.getElementById("togglePassword"),W=document.getElementById("loginPasswordConfirm"),Et=document.getElementById("confirmPasswordGroup"),N=document.getElementById("togglePasswordConfirm");document.getElementById("rememberMe");const vt=e.querySelector(".login-options"),bt=e.querySelector(".forgot-password"),At=document.getElementById("login-title"),St=document.getElementById("loginSubtitle"),M=document.getElementById("loginSubmitBtn"),B=document.getElementById("authTabLogin"),P=document.getElementById("authTabSignup");if(!t||!e)return;let O=!1,j=null,J="login";const F=i=>{J=i==="signup"?"signup":"login";const d=J==="signup";B&&(B.classList.toggle("is-active",!d),B.setAttribute("aria-selected",d?"false":"true")),P&&(P.classList.toggle("is-active",d),P.setAttribute("aria-selected",d?"true":"false")),Et&&Et.classList.toggle("hidden",!d),vt&&vt.classList.toggle("hidden",d),At&&(At.textContent=d?"Criar conta":"Entrar"),St&&(St.textContent=d?"Crie sua conta para sincronizar tema e som.":"Acesse sua conta para sincronizar suas configura√ß√µes."),M&&(M.textContent=d?"Criar conta":"Entrar"),C&&C.setAttribute("autocomplete",d?"new-password":"current-password")},kt=i=>{if(s&&s.classList.add("hidden"),r&&r.classList.add("hidden"),x&&x.classList.remove("hidden"),wt){const d=String(i||"").trim();wt.textContent=d?`Voc√™ (${d}) est√° conectado!`:"Voc√™ est√° conectado!"}z?z.focus():o&&o.focus()},U=()=>{x&&x.classList.add("hidden"),r&&r.classList.add("hidden"),s&&s.classList.remove("hidden")},Yt=()=>{if(x&&x.classList.add("hidden"),s&&s.classList.add("hidden"),r&&r.classList.remove("hidden"),B&&B.classList.remove("is-active"),P&&P.classList.remove("is-active"),c){const i=I();i&&!c.value&&(c.value=i);try{c.focus()}catch{}}},Gt=i=>{if(!O||i.key!=="Tab")return;const d=Z(e);if(!d.length)return;const u=d[0],w=d[d.length-1],E=document.activeElement;i.shiftKey?(E===u||!e.contains(E))&&(i.preventDefault(),w.focus()):E===w&&(i.preventDefault(),u.focus())},Xt=()=>{if(O=!0,j=document.activeElement,e.classList.remove("hidden"),h(e,!1),t.setAttribute("aria-expanded","true"),y("open"),Dt()){const u=I();kt(u);return}U(),F("login");const i=document.getElementById("loginEmail"),d=I();i&&d&&!i.value&&(i.value=d),i&&i.focus()},R=()=>{O=!1,e.classList.add("hidden"),h(e,!0),t.setAttribute("aria-expanded","false"),y("close"),C&&(C.type="password"),v&&(v.setAttribute("aria-pressed","false"),v.setAttribute("aria-label",m("showPasswordAria")),v.textContent=m("showPassword")),j&&typeof j.focus=="function"?j.focus():t.focus()};t.addEventListener("click",i=>{i.stopPropagation(),y("click"),O?R():Xt()}),o&&o.addEventListener("click",i=>{i.stopPropagation(),R()}),n&&n.addEventListener("submit",async i=>{i.preventDefault();const d=document.getElementById("loginEmail")?.value,u=document.getElementById("loginPassword")?.value,w=document.getElementById("loginPasswordConfirm")?.value,E=!!document.getElementById("rememberMe")?.checked;M&&(M.disabled=!0);try{const T=J==="signup";if(T&&(!w||String(w)!==String(u||"")))throw new Error("As passwords n√£o coincidem");const q=T?await ie({email:d,password:u}):await re({email:d,password:u,rememberMe:E});y("login");const H=q?.user?.email||String(d||"").trim();H&&(t.textContent=Ft(H),t.setAttribute("aria-label",`Conta: ${H}`),document.dispatchEvent(new CustomEvent("login-success"))),g("Sess√£o iniciada.","success",2e3);const tt=(()=>{try{return localStorage.getItem("theme")}catch{return null}})(),Ct=(()=>{try{return localStorage.getItem("soundMuted")==="true"}catch{return}})(),V={};if((tt==="dark"||tt==="light")&&(V.theme=tt),typeof Ct<"u"&&(V.soundMuted=Ct),Object.keys(V).length)try{await le(V)}catch{}kt(H)}catch(T){console.error("Login failed:",T),g(T?.message||"Falha ao iniciar sess√£o","error",4e3)}finally{M&&(M.disabled=!1)}}),bt&&bt.addEventListener("click",i=>{i.preventDefault(),i.stopPropagation(),Yt()}),a&&a.addEventListener("click",i=>{i.preventDefault(),i.stopPropagation(),U(),F("login"),document.getElementById("loginEmail")?.focus()}),p&&p.addEventListener("click",async i=>{i.preventDefault(),i.stopPropagation();const d=c?.value;if(!d){g("Email √© obrigat√≥rio","warning",2500),c?.focus();return}p&&(p.disabled=!0);try{const u=await ce(d);g(u?.message||"Pedido enviado.","success",3500);const w=u?.dev?.token;w&&f&&!f.value?(f.value=w,g("Token preenchido automaticamente (modo dev).","info",2500),S?.focus()):f?.focus()}catch(u){console.error("Request reset failed:",u),g(u?.message||"Falha ao pedir token","error",3500)}finally{p&&(p.disabled=!1)}}),l&&l.addEventListener("submit",async i=>{i.preventDefault();const d=f?.value,u=S?.value,w=k?.value;if(!d){g("Token √© obrigat√≥rio","warning",2500),f?.focus();return}if(!u||String(u).length<8){g("A nova password deve ter pelo menos 8 caracteres","warning",3e3),S?.focus();return}if(String(u)!==String(w||"")){g("As passwords n√£o coincidem","warning",3e3),k?.focus();return}K&&(K.disabled=!0);try{const E=await de({token:d,password:u});g(E?.message||"Password atualizada.","success",3500);const T=String(c?.value||"").trim();U(),F("login");const q=document.getElementById("loginEmail");q&&T&&!q.value&&(q.value=T),document.getElementById("loginPassword")?.focus(),f&&(f.value=""),S&&(S.value=""),k&&(k.value="")}catch(E){console.error("Reset password failed:",E),g(E?.message||"Falha ao redefinir password","error",3500)}finally{K&&(K.disabled=!1)}}),v&&C&&v.addEventListener("click",i=>{i.stopPropagation();const u=!(C.type==="text");C.type=u?"text":"password",v.setAttribute("aria-pressed",u?"true":"false"),v.setAttribute("aria-label",m(u?"hidePasswordAria":"showPasswordAria")),v.textContent=m(u?"hidePassword":"showPassword");try{C.focus()}catch{}}),N&&W&&N.addEventListener("click",i=>{i.stopPropagation();const u=!(W.type==="text");W.type=u?"text":"password",N.setAttribute("aria-pressed",u?"true":"false"),N.setAttribute("aria-label",m(u?"hidePasswordConfirmAria":"showPasswordConfirmAria")),N.textContent=m(u?"hidePassword":"showPassword");try{W.focus()}catch{}}),B&&B.addEventListener("click",i=>{i.stopPropagation(),F("login"),document.getElementById("loginEmail")?.focus()}),P&&P.addEventListener("click",i=>{i.stopPropagation(),F("signup"),document.getElementById("loginEmail")?.focus()}),z&&z.addEventListener("click",i=>{i.stopPropagation(),R()}),yt&&yt.addEventListener("click",i=>{i.stopPropagation(),Rt(),t.textContent=m("login"),t.setAttribute("aria-label",m("login")),g("Sess√£o terminada.","info",2e3),U(),F("login"),R()}),document.addEventListener("click",i=>{O&&!e.contains(i.target)&&!t.contains(i.target)&&R()}),document.addEventListener("keydown",i=>{i.key==="Escape"&&O&&R()}),document.addEventListener("keydown",Gt)}let b=null;function pe(){return b||(b=document.createElement("div"),b.id="notification-container",b.setAttribute("role","alert"),b.setAttribute("aria-live","polite"),b.style.cssText=`
    position: fixed;
    bottom: 80px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    z-index: 9999;
    pointer-events: none;
  `,document.body.appendChild(b),b)}const fe=2e3;let Ut=!0;setTimeout(()=>{Ut=!1},fe);const Bt={success:"var(--success)",warning:"var(--warning)",error:"var(--danger)",info:"var(--primary)"};function g(t,e="success",o=3e3,n=!0){n&&!Ut&&y("notification");const s=pe(),r=document.createElement("div");r.className=`notification notification-${e}`,r.textContent=t,r.setAttribute("role","alert"),r.style.cssText=`
    background-color: ${Bt[e]||Bt.success};
    color: white;
    padding: 0.75rem 1.5rem;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    opacity: 0;
    transform: translateY(20px);
    transition: opacity 0.3s ease, transform 0.3s ease;
    pointer-events: auto;
  `,s.appendChild(r),requestAnimationFrame(()=>{r.style.opacity="1",r.style.transform="translateY(0)"}),setTimeout(()=>{r.style.opacity="0",r.style.transform="translateY(20px)",setTimeout(()=>r.remove(),300)},o)}function Oe(t,e="success",o=5e3){g(t,e,o,!1)}function Fe(){document.addEventListener("keydown",t=>{if(!(t.target&&(t.target.tagName==="INPUT"||t.target.tagName==="TEXTAREA"||t.target.tagName==="SELECT")&&t.key!=="Escape")){if((t.ctrlKey||t.metaKey)&&t.shiftKey&&t.key==="P"&&(t.preventDefault(),_("pomodoroButton","pomodoroCard")),(t.ctrlKey||t.metaKey)&&t.shiftKey&&t.key==="T"&&(t.preventDefault(),_("timerButton","timerCard")),(t.ctrlKey||t.metaKey)&&t.shiftKey&&t.key==="L"&&(t.preventDefault(),_("tasklistButton","tasklistCard")),(t.ctrlKey||t.metaKey)&&t.shiftKey&&t.key==="C"&&(t.preventDefault(),_("countdownButton","countdownCard")),(t.ctrlKey||t.metaKey)&&t.shiftKey&&t.key==="W"&&(t.preventDefault(),_("worldClockButton","worldClockCard")),(t.ctrlKey||t.metaKey)&&t.shiftKey&&t.key==="S"&&(t.preventDefault(),_("stopwatchButton","stopwatchCard")),(t.ctrlKey||t.metaKey)&&t.shiftKey&&t.key==="?"&&(t.preventDefault(),Ht()),(t.ctrlKey||t.metaKey)&&t.shiftKey&&t.key==="D"){t.preventDefault();const o=document.querySelector("theme-toggle");o&&typeof o.toggleTheme=="function"&&o.toggleTheme()}if(t.key==="Escape"){const o=document.getElementById("shortcutsModal");o&&!o.classList.contains("hidden")?(Vt(),document.getElementById("shortcutsBtn")?.focus()):ge()}}})}function Ht(){const t=document.getElementById("shortcutsModal");t&&(t.classList.remove("hidden"),t.setAttribute("aria-hidden","false"),document.getElementById("shortcutsClose")?.focus())}function Vt(){const t=document.getElementById("shortcutsModal");t&&(t.classList.add("hidden"),t.setAttribute("aria-hidden","true"))}function _(t,e){const o=document.getElementById(t),n=document.getElementById(e);!o||!n||o.click()}function ge(){const t=document.querySelectorAll(".card:not(.hidden)"),e=document.querySelectorAll("#buttonContainer button.pressed");t.forEach(o=>{o.classList.add("hidden"),h(o,!0)}),e.forEach(o=>{o.classList.remove("pressed"),o.setAttribute("aria-pressed","false")})}function Re(){const t=document.querySelectorAll(".navbar-dropdown-btn"),e=document.querySelectorAll(".navbar-dropdown");let o=null;e.forEach(a=>{h(a,a.classList.contains("hidden"))});const n=({returnFocus:a=!1}={})=>{e.forEach(l=>{l.classList.add("hidden"),h(l,!0)}),t.forEach(l=>{l.classList.remove("active"),l.setAttribute("aria-expanded","false")}),a&&o&&(o.focus(),o=null)},s=a=>{const l=a.getAttribute("data-dropdown"),c=document.getElementById(`dropdown-${l}`);if(!c)return;const p=!c.classList.contains("hidden");if(n({returnFocus:!1}),!p){c.classList.remove("hidden"),a.classList.add("active"),a.setAttribute("aria-expanded","true"),h(c,!1),o=a,l==="configuracoes"&&ae("sidebarStats");const f=Z(c);f[0]&&f[0].focus()}};t.forEach(a=>{a.addEventListener("click",l=>{l.stopPropagation(),s(a),y("open")})}),document.querySelectorAll(".dropdown-close").forEach(a=>{a.addEventListener("click",l=>{l.stopPropagation(),y("close");const c=a.closest(".navbar-dropdown"),p=c?document.querySelector(`.navbar-dropdown-btn[data-dropdown="${c.id.replace("dropdown-","")}"]`):null;c&&(c.classList.add("hidden"),h(c,!0)),p&&(p.classList.remove("active"),p.setAttribute("aria-expanded","false"),p.focus())})}),document.addEventListener("click",a=>{!a.target.closest(".navbar-dropdown")&&!a.target.closest(".navbar-dropdown-btn")&&n({returnFocus:!1})}),document.addEventListener("keydown",a=>{a.key==="Escape"&&n({returnFocus:!0})})}function De(){const t=document.getElementById("focusModeBtn"),e=document.getElementById("focusModeExit"),o=document.querySelector(".navbar"),n=document.getElementById("leftSidebar"),s=document.getElementById("buttonContainer"),r=document.querySelector("footer");if(!t||!o)return;const a=()=>{document.body.classList.remove("focus-mode"),o?.classList.remove("hidden"),n?.classList.remove("hidden"),s&&s.classList.remove("hidden"),r?.classList.remove("hidden"),t?.setAttribute("aria-pressed","false"),t.textContent="Modo foco",e?.classList.add("hidden")},l=()=>{document.body.classList.add("focus-mode"),o?.classList.add("hidden"),n?.classList.add("hidden"),s&&s.classList.add("hidden"),r?.classList.add("hidden"),t.setAttribute("aria-pressed","true"),t.textContent="Modo foco (ativo)",e?.classList.remove("hidden")};t.addEventListener("click",()=>{t.getAttribute("aria-pressed")==="true"?a():l()}),e?.addEventListener("click",a)}function _e(){const t=document.getElementById("shortcutsModal"),e=document.getElementById("shortcutsBtn"),o=document.getElementById("shortcutsClose");if(!t||!o)return;const n=()=>{Vt(),e?.focus()};e?.addEventListener("click",()=>Ht()),o.addEventListener("click",n),t.addEventListener("click",s=>{s.target===t&&n()})}export{xe as A,ft as B,ae as C,Ee as a,g as b,Ce as c,Ae as d,Be as e,Ft as f,I as g,Pe as h,Dt as i,Me as j,Re as k,Fe as l,De as m,_e as n,Te as o,y as p,Se as q,ke as r,Oe as s,m as t,ye as u,Le as v,Ie as w,be as x,ve as y,le as z};
