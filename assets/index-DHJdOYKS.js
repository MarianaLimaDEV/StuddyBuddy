import{p as l,r as j,a as P,t as f,b as F,s as c,g as K,f as Y,i as T,c as G,d as J,e as V,h as X,j as Z,k as Q,l as tt,m as et,n as nt,o as it,q as st,u as ot,v as at,w as rt,x as _,y as lt,z as D,A as g,B as M,C as ct}from"./utils-BT0XPfzc.js";import{c as dt,a as I,s as z,r as k,b as mt,i as ut,d as ht,e as pt,f as ft,h as gt,j as R,k as wt,l as yt}from"./pwa-j-4_n6M-.js";import"./vendor-Dob3nYDb.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function e(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=e(i);fetch(i.href,o)}})();const vt="modulepreload",Et=function(s){return"/"+s},x={},Tt=function(t,e,n){let i=Promise.resolve();if(e&&e.length>0){let a=function(m){return Promise.all(m.map(u=>Promise.resolve(u).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const r=document.querySelector("meta[property=csp-nonce]"),d=r?.nonce||r?.getAttribute("nonce");i=a(e.map(m=>{if(m=Et(m),m in x)return;x[m]=!0;const u=m.endsWith(".css"),h=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${h}`))return;const p=document.createElement("link");if(p.rel=u?"stylesheet":vt,u||(p.as="script"),p.crossOrigin="",p.href=m,d&&p.setAttribute("nonce",d),document.head.appendChild(p),u)return new Promise((W,H)=>{p.addEventListener("load",W),p.addEventListener("error",()=>H(new Error(`Unable to preload CSS for ${m}`)))})}))}function o(a){const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=a,window.dispatchEvent(r),!r.defaultPrevented)throw a}return i.then(a=>{for(const r of a||[])r.status==="rejected"&&o(r.reason);return t().catch(o)})},It=1e3;function kt(s,t){if(!(!("Notification"in window)||Notification.permission!=="granted"))try{new Notification(s,{body:t,icon:"/SB_B.png"})}catch{}}function St(){"Notification"in window&&Notification.permission==="default"&&Notification.requestPermission().catch(()=>{})}const y=25,S=5,B=60,L=30;class Bt{constructor(){this.workTime=y,this.breakTime=S,this.timeLeft=y*60,this.isRunning=!1,this.isBreak=!1,this.interval=null,this.elements={},this.init()}init(){this.elements.workInput=document.getElementById("pomodoroWork"),this.elements.breakInput=document.getElementById("pomodoroBreak"),this.elements.startBtn=document.getElementById("pomodoroStart"),this.elements.stopBtn=document.getElementById("pomodoroStop"),this.elements.resetBtn=document.getElementById("pomodoroReset"),this.elements.display=document.getElementById("pomodoroDisplay"),this.elements.workInput&&this.elements.workInput.addEventListener("change",t=>{const e=parseInt(t.target.value,10);isNaN(e)||e<=0?(this.workTime=y,t.target.value=y):e>B?(this.workTime=B,t.target.value=B):this.workTime=e,this.isRunning||this.reset()}),this.elements.breakInput&&this.elements.breakInput.addEventListener("change",t=>{const e=parseInt(t.target.value,10);isNaN(e)||e<=0?(this.breakTime=S,t.target.value=S):e>L?(this.breakTime=L,t.target.value=L):this.breakTime=e}),this.elements.startBtn&&this.elements.startBtn.addEventListener("click",t=>{t.stopPropagation(),this.start()}),this.elements.stopBtn&&this.elements.stopBtn.addEventListener("click",t=>{t.stopPropagation(),this.stop()}),this.elements.resetBtn&&this.elements.resetBtn.addEventListener("click",t=>{t.stopPropagation(),this.reset()}),this.updateDisplay()}start(){this.isRunning||(St(),this.isRunning=!0,l("click"),this.interval=setInterval(()=>{if(this.timeLeft--,this.timeLeft<=0){const t=this.isBreak;this.isBreak=!this.isBreak,t||j(this.workTime),this.timeLeft=(this.isBreak?this.breakTime:this.workTime)*60,this.updateDisplay(),P("alarm");const e=this.isBreak?f("pomoBreakTitle"):f("pomoWorkTitle"),n=this.isBreak?`${f("pomoReminderWater")} ‚Ä¢ ${f("pomoReminderStretch")} ‚Ä¢ ${f("pomoReminderEat")}`:f("pomoWorkBody");kt(e,n);const i=this.isBreak?f("pomoBreakWellness"):f("pomoWorkToast");F(i,"info",7e3)}else this.updateDisplay()},It))}stop(){this.isRunning=!1,this.interval&&(clearInterval(this.interval),this.interval=null),l("reset")}reset(){this.stop(),this.timeLeft=this.workTime*60,this.isBreak=!1,l("reset"),this.updateDisplay()}updateDisplay(){const t=this.elements.display;if(!t)return;const e=Math.floor(this.timeLeft/60),n=this.timeLeft%60;t.textContent=`${String(e).padStart(2,"0")}:${String(n).padStart(2,"0")}`}destroy(){this.stop()}}function Lt(s,t){if(!(!("Notification"in window)||Notification.permission!=="granted"))try{new Notification(s,{body:t,icon:"/SB_B.png"})}catch{}}const bt=1e3;class At{constructor(){this.totalSeconds=0,this.timeLeft=0,this.isRunning=!1,this.interval=null,this.elements={},this.init()}init(){this.elements.startBtn=document.getElementById("timerStart"),this.elements.stopBtn=document.getElementById("timerStop"),this.elements.resetBtn=document.getElementById("timerReset"),this.elements.minInput=document.getElementById("timerMinutes"),this.elements.secInput=document.getElementById("timerSeconds"),this.elements.display=document.getElementById("timerDisplay"),this.elements.startBtn&&this.elements.startBtn.addEventListener("click",t=>{t.stopPropagation(),this.start()}),this.elements.stopBtn&&this.elements.stopBtn.addEventListener("click",t=>{t.stopPropagation(),this.stop()}),this.elements.resetBtn&&this.elements.resetBtn.addEventListener("click",t=>{t.stopPropagation(),this.reset()}),this.elements.minInput&&this.elements.minInput.addEventListener("change",()=>this.updateTotal()),this.elements.secInput&&this.elements.secInput.addEventListener("change",()=>this.updateTotal()),this.updateTotal()}updateTotal(){const t=this.elements.minInput,e=this.elements.secInput,n=t?.value?parseInt(t.value,10):0,i=e?.value?parseInt(e.value,10):0;this.totalSeconds=(isNaN(n)?0:n)*60+(isNaN(i)?0:i),this.timeLeft=this.totalSeconds,this.updateDisplay()}start(){this.isRunning||this.timeLeft<=0||("Notification"in window&&Notification.permission==="default"&&Notification.requestPermission().catch(()=>{}),this.isRunning=!0,l("click"),this.interval=setInterval(()=>{this.timeLeft--,this.updateDisplay(),this.timeLeft<=0&&(this.stop(),P("alarm"),Lt("Timer finished!","O teu temporizador terminou."),F("Timer finished!","success",5e3))},bt))}stop(){this.isRunning=!1,this.interval&&(clearInterval(this.interval),this.interval=null),l("reset")}reset(){this.stop(),this.timeLeft=this.totalSeconds,l("reset"),this.updateDisplay()}updateDisplay(){const t=this.elements.display;if(!t)return;const e=Math.floor(this.timeLeft/60),n=this.timeLeft%60;t.textContent=`${String(e).padStart(2,"0")}:${String(n).padStart(2,"0")}`}destroy(){this.stop()}}const Ct=10,v=6e4,E=1e3,$=100;class Nt{constructor(){this.startTime=0,this.elapsedTime=0,this.isRunning=!1,this.interval=null,this.laps=[],this.elements={},this.init()}init(){this.elements.startBtn=document.getElementById("stopwatchStart"),this.elements.stopBtn=document.getElementById("stopwatchStop"),this.elements.resetBtn=document.getElementById("stopwatchReset"),this.elements.lapBtn=document.getElementById("stopwatchLap"),this.elements.display=document.getElementById("stopwatchDisplay"),this.elements.lapsList=document.getElementById("stopwatchLaps"),this.elements.startBtn&&this.elements.startBtn.addEventListener("click",t=>{t.stopPropagation(),this.start()}),this.elements.stopBtn&&this.elements.stopBtn.addEventListener("click",t=>{t.stopPropagation(),this.stop()}),this.elements.resetBtn&&this.elements.resetBtn.addEventListener("click",t=>{t.stopPropagation(),this.reset()}),this.elements.lapBtn&&this.elements.lapBtn.addEventListener("click",t=>{t.stopPropagation(),this.lap()}),this.updateDisplay()}start(){this.isRunning||(this.isRunning=!0,this.startTime=Date.now()-this.elapsedTime,l("click"),this.interval=setInterval(()=>{this.elapsedTime=Date.now()-this.startTime,this.updateDisplay()},Ct))}stop(){this.isRunning=!1,this.interval&&(clearInterval(this.interval),this.interval=null),l("reset")}reset(){this.stop(),this.elapsedTime=0,this.laps=[],this.updateDisplay(),this.renderLaps()}lap(){if(!this.isRunning)return;const t=this.elapsedTime,e=this.laps.length+1;this.laps.push({number:e,time:t}),l("click"),this.renderLaps()}updateDisplay(){const t=this.elements.display;if(!t)return;const e=this.elapsedTime,n=Math.floor(e/v),i=Math.floor(e%v/E),o=Math.floor(e%E/$);t.textContent=`${String(n).padStart(2,"0")}:${String(i).padStart(2,"0")}.${String(o).padStart(2,"0")}`}formatLapTime(t){const e=Math.floor(t/v),n=Math.floor(t%v/E),i=Math.floor(t%E/$);return`${String(e).padStart(2,"0")}:${String(n).padStart(2,"0")}.${String(i).padStart(2,"0")}`}renderLaps(){const t=this.elements.lapsList;if(!t)return;if(this.laps.length===0){t.innerHTML="";return}const e=document.createDocumentFragment();this.laps.forEach((n,i)=>{const o=i===0?n.time:n.time-this.laps[i-1].time,a=document.createElement("li");a.className="lap-item",a.innerHTML=`
        <span class="lap-number">Lap ${n.number}</span>
        <span class="lap-time">${this.formatLapTime(n.time)}</span>
        <span class="lap-delta">+${this.formatLapTime(o)}</span>
      `,e.appendChild(a)}),t.innerHTML="",t.appendChild(e)}destroy(){this.stop()}}const Pt=1e3,b="countdowns",O="countdownTargetDate",U="countdownActive";function Ft(s,t){try{return s?JSON.parse(s):t}catch{return t}}function _t(s){const t=Math.max(0,s),e=Math.floor(t/(1e3*60*60*24)),n=Math.floor(t%(1e3*60*60*24)/(1e3*60*60)),i=Math.floor(t%(1e3*60*60)/(1e3*60)),o=Math.floor(t%(1e3*60)/1e3);return`${String(e).padStart(2,"0")}:${String(n).padStart(2,"0")}:${String(i).padStart(2,"0")}:${String(o).padStart(2,"0")}`}function q(){return`${Date.now()}_${Math.random().toString(16).slice(2)}`}class Dt{constructor(){this.countdowns=[],this.interval=null,this.elements={},this.init()}init(){this.elements.addBtn=document.getElementById("countdownAdd"),this.elements.resetAllBtn=document.getElementById("countdownResetAll"),this.elements.dateInput=document.getElementById("countdownDate"),this.elements.labelInput=document.getElementById("countdownLabel"),this.elements.list=document.getElementById("countdownList"),this.load(),this.elements.addBtn&&this.elements.addBtn.addEventListener("click",t=>{t.stopPropagation(),this.addCountdown()}),this.elements.resetAllBtn&&this.elements.resetAllBtn.addEventListener("click",t=>{t.stopPropagation(),this.resetAll()}),this.elements.list&&this.elements.list.addEventListener("click",t=>{const e=t.target.closest('[data-action="remove-countdown"]');if(!e)return;const n=e.getAttribute("data-id");n&&this.removeCountdown(n)}),this.render(),this.startLoop()}load(){try{const n=localStorage.getItem(O);if(n){const i=localStorage.getItem(U)==="true",o=q();this.countdowns=[{id:o,label:"Countdown",targetISO:n,active:!!i,createdAt:Date.now()}],localStorage.removeItem(O),localStorage.removeItem(U),localStorage.setItem(b,JSON.stringify(this.countdowns))}}catch{}try{const n=localStorage.getItem(b),i=Ft(n,[]);this.countdowns=Array.isArray(i)?i:[]}catch{this.countdowns=[]}const t=Date.now();let e=!1;this.countdowns.forEach(n=>{if(n?.active){const i=new Date(n.targetISO).getTime();(!Number.isFinite(i)||i<=t)&&(n.active=!1,n.completedAt=t,e=!0)}}),e&&this.save()}save(){try{localStorage.setItem(b,JSON.stringify(this.countdowns))}catch{}}addCountdown(){const t=this.elements.dateInput;if(!t)return;const e=t.value;if(!e){c("Por favor, selecione uma data e hora","warning");return}const n=new Date(e),i=n.getTime();if(!Number.isFinite(i)){c("Data inv√°lida. Tenta novamente.","warning");return}const o=(this.elements.labelInput?.value||"").trim(),a=q();this.countdowns.push({id:a,label:o||"Countdown",targetISO:n.toISOString(),active:!0,createdAt:Date.now()}),this.elements.labelInput&&(this.elements.labelInput.value=""),t.value="",this.save(),this.render(),l("open")}removeCountdown(t){const e=this.countdowns.length;this.countdowns=this.countdowns.filter(n=>n.id!==t),this.countdowns.length!==e&&(this.save(),this.render(),l("close"))}resetAll(){this.countdowns.length&&(this.countdowns=[],this.save(),this.render(),l("reset"))}startLoop(){this.interval||(this.interval=setInterval(()=>{this.tick()},Pt))}tick(){if(!this.countdowns.length)return;const t=Date.now();let e=!1;for(const n of this.countdowns){if(!n.active)continue;const i=new Date(n.targetISO).getTime();if(!Number.isFinite(i)){n.active=!1,n.completedAt=t,e=!0;continue}if(i<=t){n.active=!1,n.completedAt=t,e=!0,P("alarm");const o=n.label||"A contagem regressiva";F(`${o} terminou!`,"success",5e3)}}e&&this.save(),this.render()}render(){const t=this.elements.list;if(!t)return;if(!this.countdowns.length){t.innerHTML='<div class="empty-message">Nenhum countdown ainda. Adiciona um acima!</div>';return}const e=Date.now(),n=document.createDocumentFragment();for(const i of this.countdowns){const o=new Date(i.targetISO).getTime(),a=Number.isFinite(o)?o-e:0,r=i.active?_t(a):"00:00:00:00",d=document.createElement("div");d.className=`countdown-item ${i.active?"":"is-done"}`.trim(),d.setAttribute("role","listitem"),d.dataset.id=i.id;const m=document.createElement("span");m.className="cd-name",m.textContent=i.label||"Countdown";const u=document.createElement("span");u.className="cd-time",u.setAttribute("aria-label","Tempo restante"),u.textContent=r;const h=document.createElement("button");h.className="delete-btn",h.type="button",h.setAttribute("data-action","remove-countdown"),h.setAttribute("data-id",i.id),h.setAttribute("aria-label",`Remover ${i.label||"countdown"}`),h.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16"><path fill="currentColor" d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>',d.appendChild(m),d.appendChild(u),d.appendChild(h),n.appendChild(d)}t.innerHTML="",t.appendChild(n)}destroy(){this.interval&&(clearInterval(this.interval),this.interval=null)}}const w="/api/tasks";class Mt{constructor(){this.tasks=[],this.inFlight=new Set,this.init()}init(){const t=document.getElementById("addTaskBtn"),e=document.getElementById("taskInput");t&&t.addEventListener("click",n=>{n.stopPropagation(),this.addTask()}),e&&e.addEventListener("keypress",n=>{n.key==="Enter"&&(n.stopPropagation(),this.addTask())}),this.loadTasksFromApi(),window.addEventListener("pwa-synced",()=>this.loadTasksFromApi())}async loadTasksFromApi(){try{const t=await dt();this.tasks=(t||[]).map(e=>({id:e._id,text:e.text,done:!!e.done,createdAt:e.createdAt,completedAt:e.completedAt??null})),this.render()}catch(t){console.warn("Falha ao carregar tarefas (API + offline):",t),this.tasks=[],this.render(),c("N√£o foi poss√≠vel carregar as tarefas","warning")}}async addTask(){const t=document.getElementById("taskInput");if(!t)return;const e=t.value.trim();if(!e){c("Por favor, insira uma tarefa","warning");return}if(e.length>200){c("A tarefa n√£o pode ter mais de 200 caracteres","warning");return}if(this.tasks.some(i=>i.text.toLowerCase()===e.toLowerCase())){c("Esta tarefa j√° existe","warning");return}try{const i=await fetch(w,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:e})});if(!i.ok)throw new Error(`Erro HTTP ${i.status}`);const o=await i.json(),a={id:o._id,text:o.text,done:!!o.done,createdAt:o.createdAt,completedAt:o.completedAt??null};this.tasks.push(a),t.value="",this.render(),l("task_add")}catch(i){if(!(!navigator.onLine||i.message.includes("Failed to fetch")||i.message.includes("NetworkError"))){c("Erro ao adicionar tarefa: "+i.message,"error");return}const a=`temp-${Date.now()}`,r={_id:a,text:e,done:!1,createdAt:new Date().toISOString(),completedAt:null};this.tasks.push({id:a,text:r.text,done:!1,createdAt:r.createdAt,completedAt:null}),t.value="",this.render();try{await I({type:"POST",url:w,body:{text:e}}),await z("tasks",r),await k()}catch(d){console.error("Failed to queue offline task:",d)}l("task_add"),c("Tarefa guardada localmente; ser√° sincronizada quando houver liga√ß√£o.","info")}}async deleteTask(t){const e=[...this.tasks];this.tasks=this.tasks.filter(n=>n.id!==t),this.render();try{const n=await fetch(`${w}/${t}`,{method:"DELETE"});if(!n.ok)throw new Error(`Erro HTTP ${n.status}`);l("task_delete")}catch{try{await I({type:"DELETE",url:`${w}/${t}`,id:t}),await mt("tasks",t),await k()}catch(i){console.error("Failed to queue offline delete:",i),this.tasks=e,this.render()}l("task_delete"),c("Elimina√ß√£o ser√° sincronizada quando houver liga√ß√£o.","info")}}async toggleTask(t){const e=this.tasks.find(n=>n.id===t);if(e&&!this.inFlight.has(t)){e.done=!e.done,e.completedAt=e.done?new Date().toISOString():null,this.render(),this.inFlight.add(t);try{const n=await fetch(`${w}/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({done:e.done})});if(!n.ok)throw new Error(`Erro HTTP ${n.status}`);const i=await n.json();e.done=!!i.done,e.completedAt=i.completedAt??null,l("task_toggle")}catch{await I({type:"PUT",url:`${w}/${t}`,body:{done:e.done}}),await z("tasks",{_id:t,text:e.text,done:e.done,createdAt:e.createdAt,completedAt:e.completedAt}),await k(),l("task_toggle"),c("Altera√ß√£o guardada localmente; ser√° sincronizada quando houver liga√ß√£o.","info")}finally{this.inFlight.delete(t),this.render()}}}render(){const t=document.getElementById("taskList");if(!t)return;const e=document.createDocumentFragment();if(this.tasks.length)this.tasks.forEach(n=>{const i=document.createElement("li");i.className=`task-item ${n.done?"done":""}`,i.setAttribute("role","listitem");const o=document.createElement("input");o.type="checkbox",o.checked=n.done,o.setAttribute("aria-label",`Marcar tarefa "${n.text}" como ${n.done?"n√£o conclu√≠da":"conclu√≠da"}`),o.addEventListener("change",()=>this.toggleTask(n.id));const a=document.createElement("span");a.textContent=n.text;const r=document.createElement("button");r.className="delete-btn",r.textContent="√ó",r.setAttribute("aria-label",`Eliminar tarefa "${n.text}"`),r.addEventListener("click",()=>this.deleteTask(n.id)),i.appendChild(o),i.appendChild(a),i.appendChild(r),e.appendChild(i)});else{const n=document.createElement("li");n.className="empty-message",n.textContent="Nenhuma tarefa ainda. Adicione uma acima!",e.appendChild(n)}t.innerHTML="",t.appendChild(e)}}class zt{constructor(){this.timezones=[],this.timeFormatters=new Map,this.lastUpdate=0,this.updateInterval=1e3,this.animationFrameId=null,this.isRunning=!1,this.init()}init(){try{const n=localStorage.getItem("worldClockTimezones");this.timezones=n?JSON.parse(n):[]}catch(n){console.warn("Failed to load timezones from localStorage:",n),this.timezones=[]}this.timezones.forEach(({tz:n})=>this.getFormatter(n));const t=document.getElementById("addTimezoneBtn"),e=document.getElementById("timezoneList");t&&t.addEventListener("click",n=>{n.stopPropagation(),this.addTimezone()}),e&&e.addEventListener("click",n=>{const i=n.target.closest('[data-action="remove-tz"]');if(i){const o=i.dataset.tz;this.removeTimezone(o)}}),this.startUpdateLoop(),this.render()}getFormatter(t){return this.timeFormatters.has(t)||this.timeFormatters.set(t,new Intl.DateTimeFormat("en-US",{timeZone:t,hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1})),this.timeFormatters.get(t)}startUpdateLoop(){if(this.isRunning)return;this.isRunning=!0;const t=()=>{const e=Date.now();e-this.lastUpdate>=this.updateInterval&&(this.render(),this.lastUpdate=e),this.animationFrameId=requestAnimationFrame(t)};this.animationFrameId=requestAnimationFrame(t)}stopUpdateLoop(){this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null),this.isRunning=!1}addTimezone(){const t=document.getElementById("timezoneSelect");if(!t)return;const e=t.value,n=t.options[t.selectedIndex].text;if(!e){c("Por favor, selecione um fuso hor√°rio","warning");return}if(this.timezones.find(o=>o.tz===e)){c("Este fuso hor√°rio j√° est√° na lista","warning");return}this.timezones.push({tz:e,name:n}),this.getFormatter(e),this.save(),this.render(),l("timezone_add")}removeTimezone(t){const e=this.timezones.findIndex(n=>n.tz===t);e!==-1&&(this.timezones.splice(e,1),this.timeFormatters.delete(t),this.save(),this.render(),l("timezone_remove"))}save(){try{localStorage.setItem("worldClockTimezones",JSON.stringify(this.timezones))}catch(t){console.warn("Failed to save timezones to localStorage:",t),c("Falha ao guardar fusos hor√°rios. O armazenamento pode estar cheio.","error")}}render(){const t=document.getElementById("timezoneList");if(!t)return;if(!(this.timezones.length>0)){t.innerHTML='<div class="empty-message">Nenhum fuso hor√°rio adicionado. Selecione um acima!</div>';return}const n=document.createDocumentFragment();this.timezones.forEach(({tz:i,name:o})=>{let a;try{a=this.getFormatter(i).format(new Date)}catch{a="--:--:--"}const r=document.createElement("div");r.className="timezone-item",r.setAttribute("role","listitem"),r.dataset.tz=i,r.innerHTML=`
        <span class="tz-name">${o}</span>
        <span class="tz-time" aria-label="Hora em ${o}">${a}</span>
        <button class="delete-btn" aria-label="Remover ${o}" data-action="remove-tz" data-tz="${i}">
          <svg viewBox="0 0 24 24" width="16" height="16"><path fill="currentColor" d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      `,n.appendChild(r)}),t.innerHTML="",t.appendChild(n)}destroy(){this.stopUpdateLoop(),this.timeFormatters.clear()}}const Rt={pomodoroCard:null,timerCard:300,tasklistCard:-300,countdownCard:null,worldClockCard:600};async function xt(){const s=document.getElementById("pushNotifyBtn");if(!s)return;const t=async()=>{const e=await R();s.textContent=e?"üîï Desativar":"üîî Ativar",s.disabled=!1};await t(),s.addEventListener("click",async()=>{s.disabled=!0;try{if(await R()){(await wt({getAuthToken:M})).ok?c("Notifica√ß√µes desativadas.","info"):c("N√£o foi poss√≠vel desativar notifica√ß√µes.","error"),await t();return}const n=await yt({getAuthToken:M});n.ok?c("Notifica√ß√µes ativadas.","success"):n.reason==="denied"?c("Notifica√ß√µes recusadas.","warning"):n.reason!=="unsupported"&&c("N√£o foi poss√≠vel ativar notifica√ß√µes.","error"),await t()}catch(e){console.error("Error in push button handler:",e),c("Erro ao gerir notifica√ß√µes.","error"),await t()}})}async function $t(){try{await ut()}catch(s){console.error("Failed to initialize SW Registration:",s)}try{await ht()}catch(s){console.error("Failed to initialize Sync Manager:",s)}try{await pt()}catch(s){console.error("Failed to initialize Install Prompt:",s)}try{await ft()}catch(s){console.error("Failed to initialize Install UI:",s)}try{await gt()}catch(s){console.error("Failed to initialize Native Feel:",s)}try{await Tt(()=>import("./theme-toggle-CEDasMo8.js"),[]),console.info("Theme toggle initialized")}catch(s){console.error("Failed to initialize theme toggle:",s),C("Failed to load theme toggle functionality")}try{const s=K(),t=document.getElementById("loginButton");if(s&&t&&(t.textContent=Y(s),t.setAttribute("aria-label",`Conta: ${s}`)),T()){const e=await G();if(e?.theme==="dark"||e?.theme==="light"){const n=document.querySelector("theme-toggle");if(n&&typeof n.setTheme=="function")n.setTheme(e.theme);else{document.body.setAttribute("data-theme",e.theme);try{localStorage.setItem("theme",e.theme)}catch{}}}typeof e?.soundMuted<"u"&&(J(!!e.soundMuted),N(!!e.soundMuted))}}catch(s){console.warn("Could not load user settings from API:",s)}try{V(),X(),Z(),Q(),tt(),et(),nt(),it(),st(),xt(),A(),window.addEventListener("studystats-updated",A),document.addEventListener("i18n-changed",A),Ot(),console.info("UI utilities initialized")}catch(s){console.error("Failed to initialize UI utilities:",s),C("Failed to initialize drag and navbar functionality")}try{const s=()=>{Object.entries(Rt).forEach(([n,i])=>{const o=document.getElementById(n);if(o&&i!==null&&i!==void 0){const a=o.offsetWidth||400,r=window.innerWidth;let d=r/2+i;const m=10,u=r-a-10;d=Math.max(m,Math.min(d,u)),o.style.left=`${d}px`,o.style.transform="none"}})};s();let t;const e=150;window.addEventListener("resize",()=>{clearTimeout(t),t=setTimeout(s,e)}),console.info("Card positions configured with viewport boundaries")}catch(s){console.error("Failed to configure card positions:",s)}try{const s=new Bt,t=new At,e=window.stopwatchInstance=new Nt,n=new Dt,i=window.worldClockInstance=new zt;console.info("All timer features initialized")}catch(s){console.error("Failed to initialize timer features:",s),C("Failed to load timer functionality")}try{const s=()=>{try{window.taskListInstance=new Mt}catch(t){console.error("Failed to initialize TaskList:",t)}};"requestIdleCallback"in window?window.requestIdleCallback(s,{timeout:1500}):setTimeout(s,0)}catch(s){console.error("Failed to schedule TaskList init:",s)}try{ot(),console.info("üîä Sound manager initialized"),at(),console.info("üîä Global click sound initialized"),rt();const s="introAutoplayAllowed";let t=!1;const e=()=>{if(t||_())return;const i=new Audio("/sfx/INTRO.mp3");i.volume=.7,i.play().then(()=>{t=!0;try{localStorage.setItem(s,"true")}catch{}}).catch(()=>{})};if(e(),!(()=>{try{return localStorage.getItem(s)==="true"}catch{return!1}})()){const i=()=>{t||e()};document.addEventListener("click",i,{once:!0}),document.addEventListener("keydown",i,{once:!0}),document.addEventListener("touchstart",i,{once:!0})}}catch(s){console.error("Failed to initialize sound manager:",s)}try{const s=document.getElementById("muteToggle");s&&(_()&&N(!0),s.addEventListener("click",async()=>{const t=lt();if(N(t),l("mute_toggle"),c(t?"Som desativado":"Som ativado","info",2e3),T())try{await D({soundMuted:t})}catch{}})),console.info("Mute toggle configured")}catch(s){console.error("Failed to configure mute toggle:",s)}try{g("pomodoroButton","pomodoroCard"),g("timerButton","timerCard"),g("stopwatchButton","stopwatchCard"),g("tasklistButton","tasklistCard"),g("countdownButton","countdownCard"),g("worldClockButton","worldClockCard"),console.info("Toggle buttons configured");const t=new URLSearchParams(window.location.search).get("tool"),n=t&&{pomodoro:"pomodoroButton",timer:"timerButton",stopwatch:"stopwatchButton",tasklist:"tasklistButton",countdown:"countdownButton",worldclock:"worldClockButton"}[t.toLowerCase()];if(n){const i=document.getElementById(n);i&&setTimeout(()=>i.click(),100)}}catch(s){console.error("Failed to configure toggle buttons:",s)}try{let s=null;new MutationObserver(()=>{if(!T())return;const e=document.body.getAttribute("data-theme");e!=="dark"&&e!=="light"||(clearTimeout(s),s=setTimeout(async()=>{try{await D({theme:e})}catch{}},300))}).observe(document.body,{attributes:!0,attributeFilter:["data-theme"]})}catch{}}function A(){ct("sidebarStats")}function Ot(){const s=document.getElementById("sidebarTab"),t=document.getElementById("leftSidebar"),e=document.getElementById("sidebarIndicator");if(!t)return;const n=()=>{const i=document.body.classList.toggle("sidebar-open");s?.setAttribute("aria-expanded",i),s&&(s.textContent=i?"√ó":"‚Ä∫")};s?.addEventListener("click",n),e?.addEventListener("click",i=>{i.stopPropagation(),n()})}function C(s){let t=document.getElementById("error-notification");t||(t=document.createElement("div"),t.id="error-notification",t.setAttribute("role","alert"),t.setAttribute("aria-live","assertive"),t.style.cssText=`
      position: fixed;
      bottom: 20px;
      right: 20px;
      background-color: var(--danger);
      color: white;
      padding: 1rem 1.5rem;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      z-index: 10000;
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.3s ease, transform 0.3s ease;
    `,document.body.appendChild(t)),t.textContent=s,t.style.opacity="1",t.style.transform="translateY(0)",setTimeout(()=>{t.style.opacity="0",t.style.transform="translateY(20px)"},5e3)}function N(s){const t=document.getElementById("muteToggle");if(!t)return;const e=t.querySelector(".mute-icon"),n=t.querySelector(".unmute-icon");s?(e&&(e.style.display="none"),n&&(n.style.display="inline"),t.setAttribute("aria-pressed","true")):(e&&(e.style.display="inline"),n&&(n.style.display="none"),t.setAttribute("aria-pressed","false"))}document.addEventListener("DOMContentLoaded",$t);
