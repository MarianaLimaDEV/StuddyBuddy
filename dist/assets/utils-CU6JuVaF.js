import{s as ue,g as _e,a as ot,b as nt,r as st,c as $}from"./pwa-Bvh0rDGd.js";const Ee={intro:"/sfx/INTRO.mp3",open:"/sfx/OPEN.mp3",close:"/sfx/CLOSE.mp3",click:"/sfx/CLICK.mp3",interact:"/sfx/INTERACT.mp3",notification:"/sfx/NOTIFICATION.mp3",alarm:"/sfx/ALARM.mp3",reset:"/sfx/RESET.mp3",task_add:"/sfx/CLICK.mp3",task_delete:"/sfx/CLOSE.mp3",task_toggle:"/sfx/CLICK.mp3",mute_toggle:"/sfx/CLICK.mp3",login:"/sfx/OPEN.mp3",countdown_stop:"/sfx/RESET.mp3",timezone_add:"/sfx/OPEN.mp3",timezone_remove:"/sfx/CLOSE.mp3"},me=new Map;let T=!0,xe=!1;const ve="soundMuted";try{localStorage.getItem(ve)==="true"&&(T=!1)}catch{}function te(){if(xe)return;const e=new Audio("data:audio/wav;base64,UklGRigAAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQAAAAA=");e.volume=.01,e.play().then(()=>{xe=!0,console.info("üîä Audio context unlocked"),e.pause()}).catch(o=>{console.warn("Could not unlock audio context:",o)})}document.addEventListener("click",te,{once:!0});document.addEventListener("keydown",te,{once:!0});document.addEventListener("touchstart",te,{once:!0});function at(e){if(me.has(e))return;const o=Ee[e];if(!o){console.warn(`Sound "${e}" not found in sound mappings`);return}const t=new Audio(o);t.preload="auto",t.volume=.7,t.addEventListener("error",n=>{console.error(`‚ùå Failed to load sound "${e}" from "${o}":`,n),console.error("‚ùå Error details:",{code:t.error?.code,message:t.error?.message,MEDIA_ERR_ABORTED:1,MEDIA_ERR_NETWORK:2,MEDIA_ERR_DECODE:3,MEDIA_ERR_SRC_NOT_SUPPORTED:4})}),t.addEventListener("canplaythrough",()=>{}),t.addEventListener("loadstart",()=>{}),me.set(e,t)}function rt(){Object.keys(Ee).forEach(e=>{at(e)})}function Tt(){rt(),console.info("üîä Sound manager initialized"),te()}function b(e,{overlap:o=!1}={}){if(!T)return;const t=Ee[e];if(!t){console.warn(`Sound "${e}" not configured`);return}const n=me.get(e);if(n)if(o){const a=n.cloneNode();a.volume=n.volume||.7,a.play().then(()=>{}).catch(r=>{console.error(`Failed to play sound "${e}":`,r),ce(e,t)})}else n.currentTime=0,n.volume=n.volume||.7,n.play().then(()=>console.debug(`Playing sound "${e}"`)).catch(a=>{console.error(`Failed to play sound "${e}":`,a),ce(e,t)});else ce(e,t)}function ce(e,o){try{const t=new Audio(o);t.volume=.7,t.play().then(()=>{}).catch(n=>console.error(`Fallback play failed for "${e}":`,n))}catch(t){console.error(`Could not create audio for "${e}":`,t)}}function Lt(e){b(e,{overlap:!0})}function It(){T=!T,console.info(`Sound ${T?"enabled":"disabled"}`);try{localStorage.setItem(ve,String(!T))}catch{}return!T}function Pt(){return!T}function Bt(e){T=!e;try{localStorage.setItem(ve,String(e))}catch{}}const Re="lang";let ee=null;const it={skipLink:{pt:"Saltar para o conte√∫do principal",en:"Skip to main content"},sidebarAria:{pt:"Estat√≠sticas e modo foco",en:"Stats and focus mode"},sidebarTabAria:{pt:"Abrir painel lateral",en:"Open side panel"},focusMode:{pt:"Modo foco",en:"Focus mode"},focusModeAria:{pt:"Ativar modo foco",en:"Activate focus mode"},focusModeExit:{pt:"Sair modo foco",en:"Exit focus mode"},focusModeExitAria:{pt:"Sair do modo foco",en:"Exit focus mode"},navAria:{pt:"Menu principal",en:"Main menu"},logoAria:{pt:"StuddyBuddy - P√°gina inicial",en:"StuddyBuddy - Home"},principal:{pt:"Principal",en:"Home"},principalText:{pt:"Bem-vindo ao StuddyBuddy! Acede √†s ferramentas clicando nos bot√µes abaixo: Pomodoro, Timer, Cron√≥metro, Task List, Countdown e World Clock. Podes abrir v√°rias ao mesmo tempo e arrast√°-las no ecr√£. Usa o modo foco para esconder a navega√ß√£o e concentrares-te no estudo.",en:"Welcome to StuddyBuddy! Access the tools by clicking the buttons below: Pomodoro, Timer, Stopwatch, Task List, Countdown and World Clock. You can open several at once and drag them on screen. Use focus mode to hide navigation and focus on studying."},sobre:{pt:"Sobre",en:"About"},sobreText:{pt:"O StuddyBuddy √© uma plataforma de estudo com ferramentas pr√°ticas: Pomodoro para sess√µes de foco, Timer, Cron√≥metro, lista de tarefas, contagem regressiva e rel√≥gio mundial. Faz login para sincronizar o teu tema e prefer√™ncias na nuvem.",en:"StuddyBuddy is a study platform with practical tools: Pomodoro for focus sessions, Timer, Stopwatch, task list, countdown and world clock. Log in to sync your theme and preferences in the cloud."},servicos:{pt:"Servi√ßos",en:"Services"},servicosText:{pt:"Pomodoro (trabalho/pausa), Timer personaliz√°vel, Cron√≥metro com voltas, Task List com backend, Countdown para datas importantes e World Clock com v√°rios fusos. Todas as ferramentas funcionam offline e podem ser instaladas como app (PWA).",en:"Pomodoro (work/break), customizable Timer, Stopwatch with laps, Task List with backend, Countdown for important dates and World Clock with multiple timezones. All tools work offline and can be installed as an app (PWA)."},configuracoes:{pt:"Configura√ß√µes",en:"Settings"},appLabel:{pt:"App",en:"App"},appInstall:{pt:"Instalar",en:"Install"},appInstallAria:{pt:"Instalar a app",en:"Install the app"},appDownload:{pt:"Download",en:"Download"},appDownloadAria:{pt:"Baixar / instalar a app",en:"Download / install the app"},appInstallHint:{pt:"Clica em ‚ÄúDownload‚Äù para ver as op√ß√µes de instala√ß√£o. No iOS: ‚ÄúPartilhar‚Äù ‚Üí ‚ÄúAdicionar ao ecr√£ principal‚Äù.",en:"Click ‚ÄúDownload‚Äù to see install options. On iOS: ‚ÄúShare‚Äù ‚Üí ‚ÄúAdd to Home Screen‚Äù."},appInstallReady:{pt:"Instala√ß√£o dispon√≠vel neste browser.",en:"Install is available in this browser."},appAlreadyInstalled:{pt:"A app j√° est√° instalada.",en:"The app is already installed."},appInstalledBtn:{pt:"Instalada",en:"Installed"},appInstalled:{pt:"App instalada com sucesso.",en:"App installed successfully."},appInstallDismissed:{pt:"Instala√ß√£o cancelada.",en:"Install dismissed."},appInstallIosHint:{pt:"No iPhone/iPad: toca em ‚ÄúPartilhar‚Äù ‚Üí ‚ÄúAdicionar ao ecr√£ principal‚Äù.",en:"On iPhone/iPad: tap ‚ÄúShare‚Äù ‚Üí ‚ÄúAdd to Home Screen‚Äù."},appInstallDesktopHint:{pt:"Para instalar: abre no Chrome/Edge e usa ‚ÄúInstalar app‚Äù no menu/barra de endere√ßo.",en:"To install: open in Chrome/Edge and use ‚ÄúInstall app‚Äù from the menu/address bar."},tema:{pt:"Tema",en:"Theme"},som:{pt:"Som",en:"Sound"},soundAria:{pt:"Ativar/desativar som",en:"Toggle sound"},faq:{pt:"FAQ",en:"FAQ"},faqAria:{pt:"Perguntas frequentes",en:"Frequently asked questions"},faq1Q:{pt:"Como fa√ßo login?",en:"How do I log in?"},faq1A:{pt:"Abre o menu <strong>Login</strong>, escreve o teu email e password, e confirma. Se ainda n√£o existir conta, o sistema cria automaticamente (exemplo fict√≠cio).",en:"Open the <strong>Login</strong> menu, enter your email and password, and confirm. If no account exists yet, the system creates one automatically (fictional example)."},faq2Q:{pt:"Como alterar o tema (claro/escuro)?",en:"How do I change the theme (light/dark)?"},faq2A:{pt:"Vai em <strong>Configura√ß√µes</strong> e muda o <strong>Tema</strong>. Ao estar conectado, o tema √© guardado para a pr√≥xima vez (texto fict√≠cio).",en:"Go to <strong>Settings</strong> and change the <strong>Theme</strong>. When connected, the theme is saved for next time (fictional text)."},faq3Q:{pt:"Como ativar/desativar o som?",en:"How do I enable/disable sound?"},faq3A:{pt:"Em <strong>Configura√ß√µes</strong>, clica no bot√£o de <strong>Som</strong>. Exemplo: ao desativar, o √≠cone muda e o estado fica guardado.",en:"In <strong>Settings</strong>, click the <strong>Sound</strong> button. Example: when disabled, the icon changes and the state is saved."},faq4Q:{pt:"Os meus dados ficam guardados?",en:"Is my data saved?"},faq4A:{pt:"Sim: as <strong>configura√ß√µes</strong> ficam associadas ao teu email (texto fict√≠cio). As ferramentas podem ter comportamentos diferentes dependendo do m√≥dulo.",en:"Yes: <strong>settings</strong> are associated with your email (fictional text). Tools may behave differently depending on the module."},faq5Q:{pt:"Posso abrir v√°rias ferramentas ao mesmo tempo?",en:"Can I open several tools at once?"},faq5A:{pt:"Sim. Podes abrir mais do que um card e organizar no ecr√£. Exemplo fict√≠cio: Pomodoro + TaskList lado a lado.",en:"Yes. You can open more than one card and arrange them on screen. Fictional example: Pomodoro + TaskList side by side."},faq6Q:{pt:"Perdi a password. E agora?",en:"I forgot my password. What now?"},faq6A:{pt:"Exemplo fict√≠cio: clica em <strong>Forgot password?</strong> e segue as instru√ß√µes. (Ainda pode ser uma funcionalidade futura.)",en:"Fictional example: click <strong>Forgot password?</strong> and follow the instructions. (May be a future feature.)"},shortcutsBtn:{pt:"‚å®Ô∏è Atalhos",en:"‚å®Ô∏è Shortcuts"},shortcutsAria:{pt:"Ver atalhos de teclado",en:"View keyboard shortcuts"},contacto:{pt:"Contacto",en:"Contact"},contactoText:{pt:"Entre em contacto!",en:"Get in touch!"},login:{pt:"Login",en:"Login"},navToggleAria:{pt:"Alternar menu de navega√ß√£o",en:"Toggle navigation menu"},dropdownClose:{pt:"Fechar",en:"Close"},pomodoro:{pt:"Pomodoro",en:"Pomodoro"},timer:{pt:"Timer",en:"Timer"},stopwatch:{pt:"Cron√≥metro",en:"Stopwatch"},tasklist:{pt:"TaskList",en:"TaskList"},countdown:{pt:"Countdown",en:"Countdown"},worldClock:{pt:"World Clock",en:"World Clock"},pomodoroTitle:{pt:"Pomodoro Timer",en:"Pomodoro Timer"},timerTitle:{pt:"Timer",en:"Timer"},stopwatchTitle:{pt:"Cron√≥metro",en:"Stopwatch"},tasklistTitle:{pt:"Task List",en:"Task List"},countdownTitle:{pt:"Countdown",en:"Countdown"},worldclockTitle:{pt:"World Clock",en:"World Clock"},workMin:{pt:"Tempo de trabalho em minutos",en:"Work time in minutes"},breakMin:{pt:"Tempo de pausa em minutos",en:"Break time in minutes"},start:{pt:"Start",en:"Start"},stop:{pt:"Stop",en:"Stop"},reset:{pt:"Reset",en:"Reset"},add:{pt:"Add",en:"Add"},lap:{pt:"Lap",en:"Lap"},taskPlaceholder:{pt:"Adicionar nova tarefa...",en:"Add a new task..."},taskLabel:{pt:"Nova tarefa",en:"New task"},addTaskAria:{pt:"Adicionar tarefa",en:"Add task"},countdownLabelPlaceholder:{pt:"T√≠tulo (opcional)",en:"Title (optional)"},countdownLabelAria:{pt:"Nome do countdown",en:"Countdown name"},countdownDateAria:{pt:"Data e hora de destino",en:"Target date and time"},addCountdownAria:{pt:"Adicionar countdown",en:"Add countdown"},resetCountdownAria:{pt:"Resetar todos os countdowns",en:"Reset all countdowns"},timezoneAria:{pt:"Selecionar fuso hor√°rio",en:"Select timezone"},addTimezoneAria:{pt:"Adicionar fuso hor√°rio",en:"Add timezone"},minutes:{pt:"Minutos",en:"Minutes"},seconds:{pt:"Segundos",en:"Seconds"},timeRemaining:{pt:"Tempo restante",en:"Time remaining"},elapsed:{pt:"Tempo decorrido",en:"Elapsed time"},closePomodoro:{pt:"Fechar Pomodoro Timer",en:"Close Pomodoro Timer"},closeTimer:{pt:"Fechar Timer",en:"Close Timer"},closeStopwatch:{pt:"Fechar Cron√≥metro",en:"Close Stopwatch"},closeTasklist:{pt:"Fechar Lista de Tarefas",en:"Close Task List"},closeCountdown:{pt:"Fechar Contagem Regressiva",en:"Close Countdown"},closeWorldclock:{pt:"Fechar Rel√≥gio Mundial",en:"Close World Clock"},entrar:{pt:"Entrar",en:"Log in"},criarConta:{pt:"Criar conta",en:"Create account"},loginSubtitle:{pt:"Acesse sua conta para sincronizar suas configura√ß√µes.",en:"Access your account to sync your settings."},rememberMe:{pt:"Lembrar-me",en:"Remember me"},forgotPassword:{pt:"Forgot password?",en:"Forgot password?"},confirmPassword:{pt:"Confirmar password",en:"Confirm password"},showPassword:{pt:"Mostrar",en:"Show"},showPasswordAria:{pt:"Mostrar password",en:"Show password"},hidePassword:{pt:"Ocultar",en:"Hide"},hidePasswordAria:{pt:"Ocultar password",en:"Hide password"},hidePasswordConfirmAria:{pt:"Ocultar confirma√ß√£o de password",en:"Hide password confirmation"},orContinue:{pt:"ou continuar com",en:"or continue with"},showPasswordConfirmAria:{pt:"Mostrar confirma√ß√£o de password",en:"Show password confirmation"},signUp:{pt:"Criar conta",en:"Sign up"},noAccount:{pt:"Don't have an account?",en:"Don't have an account?"},connected:{pt:"Conectado",en:"Connected"},connectedMsg:{pt:"Voc√™ est√° conectado!",en:"You're connected!"},ok:{pt:"Ok",en:"Ok"},signOut:{pt:"Sair",en:"Sign out"},closeLogin:{pt:"Fechar Login",en:"Close Login"},footer:{pt:"¬© 2026 StuddyBuddy. Desenvolvido por Mariana Lima.",en:"¬© 2026 StuddyBuddy. Developed by Mariana Lima."},cookies:{pt:"Cookies",en:"Cookies"},cookieText:{pt:"Usamos cookies essenciais para o funcionamento do site e cookies de prefer√™ncia para guardar op√ß√µes como tema e som.",en:"We use essential cookies for site functionality and preference cookies to save options like theme and sound."},accept:{pt:"Aceitar",en:"Accept"},reject:{pt:"Recusar",en:"Reject"},shortcutsTitle:{pt:"Atalhos de teclado",en:"Keyboard shortcuts"},shortcutsCloseAria:{pt:"Fechar",en:"Close"},shortcutStopwatch:{pt:"Cron√≥metro",en:"Stopwatch"},shortcutTheme:{pt:"Alternar tema",en:"Toggle theme"},shortcutShortcuts:{pt:"Ver atalhos",en:"View shortcuts"},shortcutCloseCards:{pt:"Fechar cards",en:"Close cards"},langLabel:{pt:"Idioma",en:"Language"},langBtn:{pt:"üåê PT",en:"üåê EN"},langBtnAria:{pt:"Mudar idioma para Ingl√™s",en:"Change language to Portuguese"},account:{pt:"Conta",en:"Account"},statsTitle:{pt:"Estat√≠sticas de estudo",en:"Study statistics"},statsToday:{pt:"Hoje:",en:"Today:"},statsWeek:{pt:"√öltimos 7 dias:",en:"Last 7 days:"},statsTotal:{pt:"Total:",en:"Total:"},statsSessions:{pt:"Sess√µes:",en:"Sessions:"},pomoBreakTitle:{pt:"Pausa!",en:"Break time!"},pomoBreakBody:{pt:"Tempo de descanso. Aproveita para cuidar de ti!",en:"Time to rest. Take care of yourself!"},pomoReminderWater:{pt:"üíß Bebe √°gua",en:"üíß Drink water"},pomoReminderStretch:{pt:"ü§∏ Alonga-te",en:"ü§∏ Stretch"},pomoReminderEat:{pt:"üçé Come algo saud√°vel",en:"üçé Eat something healthy"},pomoBreakWellness:{pt:"Pausa! Bebe √°gua ‚Ä¢ Alonga-te ‚Ä¢ Come algo saud√°vel",en:"Break! Drink water ‚Ä¢ Stretch ‚Ä¢ Eat something healthy"},pomoWorkTitle:{pt:"Tempo de trabalho!",en:"Work time!"},pomoWorkBody:{pt:"Mant√©m o foco!",en:"Stay focused!"},pomoWorkToast:{pt:"Hora de trabalhar! Mant√©m o foco!",en:"Work time! Stay focused!"}};function be(){if(ee==="en"||ee==="pt")return ee;try{const e=localStorage.getItem(Re);if(e==="en"||e==="pt")return e}catch{}return"pt"}function ct(e){if(!(e!=="pt"&&e!=="en")){ee=e;try{localStorage.setItem(Re,e)}catch{}}}function f(e,o=be()){const t=it[e];return t?t[o]??t.pt??"":""}function pe(){const e=be();document.documentElement.lang=e==="pt"?"pt-PT":"en",document.querySelectorAll("[data-i18n]").forEach(t=>{const n=t.getAttribute("data-i18n");if(t.id==="loginButton"&&Ke()){const r=he(x());t.textContent=r==="Conta"?f("account"):r,t.setAttribute("aria-label",`${f("account")}: ${x()}`);return}const a=f(n);a&&t.tagName!=="INPUT"&&t.tagName!=="TEXTAREA"&&(/^faq\dA$/.test(n)?t.innerHTML=a:t.textContent=a)}),document.querySelectorAll("[data-i18n-placeholder]").forEach(t=>{const n=t.getAttribute("data-i18n-placeholder");t.placeholder=f(n)}),document.querySelectorAll("[data-i18n-aria]").forEach(t=>{const n=t.getAttribute("data-i18n-aria"),a=f(n);a&&t.setAttribute("aria-label",a)});const o=document.getElementById("langBtn");o&&(o.textContent=e==="pt"?"üåê EN":"üåê PT",o.setAttribute("aria-label",f("langBtnAria"))),document.dispatchEvent(new CustomEvent("i18n-changed",{detail:{lang:e}}))}function dt(){const e=be()==="pt"?"en":"pt";ct(e),pe()}function xt(){const e=document.getElementById("langBtn");e&&(e.addEventListener("click",o=>{o.preventDefault(),o.stopPropagation(),dt()}),pe(),document.addEventListener("login-success",pe))}const Ne="studdybuddy_study_stats";function qe(){try{const e=localStorage.getItem(Ne);if(!e)return{sessions:[],totalMinutes:0};const o=JSON.parse(e);return{sessions:o.sessions||[],totalMinutes:o.totalMinutes||0}}catch{return{sessions:[],totalMinutes:0}}}function lt(e,o){try{localStorage.setItem(Ne,JSON.stringify({sessions:e,totalMinutes:o}))}catch{}}function Mt(e){const{sessions:o,totalMinutes:t}=qe(),n=new Date;o.push({date:n.toISOString().slice(0,10),minutes:e});const a=t+e;return lt(o.slice(-500),a),window.dispatchEvent(new CustomEvent("studystats-updated")),a}function de(e){if(e<60)return`${e} min`;const o=Math.floor(e/60),t=e%60;return t?`${o}h ${t}min`:`${o}h`}function ut(e){const o=document.getElementById(e);if(!o)return;const{sessions:t,totalMinutes:n}=qe(),a=new Date().toISOString().slice(0,10),r=t.filter(c=>c.date===a).reduce((c,p)=>c+p.minutes,0),s=new Date;s.setDate(s.getDate()-7);const d=t.filter(c=>c.date>=s.toISOString().slice(0,10)).reduce((c,p)=>c+p.minutes,0);o.innerHTML=`
    <div class="stats-box">
      <h4 class="stats-title">${f("statsTitle")}</h4>
      <div class="stats-row">
        <span>${f("statsToday")}</span>
        <strong>${de(r)}</strong>
      </div>
      <div class="stats-row">
        <span>${f("statsWeek")}</span>
        <strong>${de(d)}</strong>
      </div>
      <div class="stats-row">
        <span>${f("statsTotal")}</span>
        <strong>${de(n)}</strong>
      </div>
      <div class="stats-row">
        <span>${f("statsSessions")}</span>
        <strong>${t.length}</strong>
      </div>
    </div>
  `}const Me=(import.meta?.env?.VITE_GOOGLE_CLIENT_ID||"").trim(),fe="authToken",ge="userEmail";function Ae(){try{return localStorage.getItem(fe)}catch{return null}}function oe(e){try{e?localStorage.setItem(fe,e):localStorage.removeItem(fe)}catch{}}function x(){try{return localStorage.getItem(ge)}catch{return null}}function he(e){const o=String(e||"").trim();return o?o.split("@")[0]||o:"Conta"}function ne(e){try{e?localStorage.setItem(ge,e):localStorage.removeItem(ge)}catch{}}function $e(){oe(null),ne(null)}function Ke(){return!!Ae()}async function ze(e,o={}){const t=Ae(),n=new Headers(o.headers||{});t&&n.set("Authorization",`Bearer ${t}`);const a=await $(e,{...o,headers:n});return a.status===401&&$e(),a}async function mt({email:e,password:o,rememberMe:t}){const n=String(e||"").trim().toLowerCase(),a=String(o||"");if(!n)throw new Error("Email √© obrigat√≥rio");if(!a)throw new Error("Password √© obrigat√≥ria");const r=await $("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,password:a,rememberMe:!!t})});if(!r.ok){let d=`Erro HTTP ${r.status}`;try{const c=await r.json();c?.message&&(d=c.message)}catch{}throw new Error(d)}const s=await r.json();if(!s?.token)throw new Error("Resposta de login inv√°lida (token em falta)");return oe(s.token),ne(s?.user?.email||n),s}async function pt({email:e,password:o}){const t=String(e||"").trim().toLowerCase(),n=String(o||"");if(!t)throw new Error("Email √© obrigat√≥rio");if(!n||n.length<8)throw new Error("Password deve ter pelo menos 8 caracteres");const a=await $("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,password:n})});if(!a.ok){let s=`Erro HTTP ${a.status}`;try{const d=await a.json();d?.message&&(s=d.message)}catch{}throw new Error(s)}const r=await a.json();if(!r?.token)throw new Error("Resposta de registo inv√°lida (token em falta)");return oe(r.token),ne(r?.user?.email||t),r}async function ft({credential:e,rememberMe:o}){const t=await $("/api/auth/google",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({credential:e,rememberMe:!!o})});if(!t.ok){let a=`Erro HTTP ${t.status}`;try{const r=await t.json();r?.message&&(a=r.message)}catch{}throw new Error(a)}const n=await t.json();if(!n?.token)throw new Error("Resposta de login Google inv√°lida (token em falta)");return oe(n.token),ne(n?.user?.email||""),n}async function gt(e){const o=String(e||"").trim().toLowerCase();if(!o)throw new Error("Email √© obrigat√≥rio");const t=await $("/api/auth/forgot-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:o})});if(!t.ok){let n=`Erro HTTP ${t.status}`;try{const a=await t.json();a?.message&&(n=a.message)}catch{}throw new Error(n)}return await t.json()}async function ht({token:e,password:o}){const t=String(e||"").trim(),n=String(o||"");if(!t)throw new Error("Token √© obrigat√≥rio");if(!n||n.length<8)throw new Error("Password deve ter pelo menos 8 caracteres");const a=await $("/api/auth/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:t,password:n})});if(!a.ok){let r=`Erro HTTP ${a.status}`;try{const s=await a.json();s?.message&&(r=s.message)}catch{}throw new Error(r)}return await a.json()}async function Ot(){const o=`userSettings:${x()||"anon"}`;try{const t=await ze("/api/user/settings");if(!t.ok){let a=`Erro HTTP ${t.status}`;try{const r=await t.json();r?.message&&(a=r.message)}catch{}throw new Error(a)}const n=await t.json();try{await ue("dados",{_id:o,...n||{}})}catch(a){console.warn("Failed to cache user settings:",a)}return n}catch(t){const n=await _e("dados",o).catch(()=>null);if(n){const{_id:a,...r}=n;return r}throw t}}async function yt(e){const o=e||{};let t;try{t=await ze("/api/user/settings",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})}catch{const c=`userSettings:${x()||"anon"}`,g={...await _e("dados",c).catch(()=>null)||{},...o};try{await ue("dados",{_id:c,...g})}catch(m){console.warn("Failed to save offline settings:",m)}const A=Ae();if(A)try{await ot({type:"PUT",url:nt("/api/user/settings"),body:o,headers:{Authorization:`Bearer ${A}`}}),await st()}catch(m){console.warn("Failed to register background sync:",m)}return g}if(!t.ok){let s=`Erro HTTP ${t.status}`;try{const d=await t.json();d?.message&&(s=d.message)}catch{}throw new Error(s)}const n=await t.json(),r=`userSettings:${x()||"anon"}`;try{await ue("dados",{_id:r,...n||{}})}catch(s){console.warn("Failed to cache user settings:",s)}return n}const ye="cookieConsent";function wt(){try{return localStorage.getItem(ye)}catch{return null}}function Oe(e){try{e?localStorage.setItem(ye,e):localStorage.removeItem(ye)}catch{}}function Dt(){const e=document.getElementById("cookieBanner"),o=document.getElementById("cookieAccept"),t=document.getElementById("cookieReject");if(!e||!o||!t)return;const n=()=>{e.classList.remove("hidden"),e.setAttribute("aria-hidden","false"),o.focus()},a=()=>{e.classList.add("hidden"),e.setAttribute("aria-hidden","true")};wt()?a():n(),o.addEventListener("click",s=>{s.stopPropagation(),Oe("accepted"),a()}),t.addEventListener("click",s=>{s.stopPropagation(),Oe("rejected"),a()})}function se(e){return e?Array.from(e.querySelectorAll(["a[href]","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])",'[tabindex]:not([tabindex="-1"])'].join(","))).filter(o=>{const t=window.getComputedStyle(o);return t.visibility!=="hidden"&&t.display!=="none"}):[]}function Q(e,o){e&&e.setAttribute("aria-expanded",o?"true":"false")}function E(e,o){e&&(o?(e.setAttribute("hidden",""),e.setAttribute("inert","")):(e.removeAttribute("hidden"),e.removeAttribute("inert")))}let Z=null,J=null;function Ft(){Z&&document.removeEventListener("click",Z),Z=e=>{e.target.closest(".card-close")||e.target.closest(".dropdown-close")||e.target.closest(".login-popup-close")||e.target.closest("#muteToggle")||e.target.tagName==="INPUT"||e.target.tagName==="TEXTAREA"||e.target.tagName==="SELECT"||e.target.closest("input")||e.target.closest("textarea")||e.target.closest("select")||b("click")},document.addEventListener("click",Z,{passive:!0}),console.info("üîä Global click sound initialized (CLICK.mp3 on all clicks)")}function _t(){J&&document.removeEventListener("focusin",J);const e=o=>{if(!o||o.disabled||o.readOnly)return!1;if(o.tagName==="TEXTAREA"||o.tagName==="SELECT")return!0;if(o.tagName!=="INPUT")return!1;const t=(o.getAttribute("type")||"text").toLowerCase();return!["checkbox","radio","button","submit","reset","range","color","file","hidden"].includes(t)};J=o=>{const t=o.target;e(t)&&b("interact")},document.addEventListener("focusin",J,{passive:!0}),console.info("üîä Global input focus sound initialized (INTERACT on focus)")}let B=null,je=0,He=0,We=0,Ue=0,j=!1;const De=5,Ve=900,Et=995;let N=Ve;function le(e){e&&(N+=1,N>Et&&(N=Ve,Array.from(document.querySelectorAll(".card:not(.hidden)")).forEach(t=>{N+=1,t.style.zIndex=String(N)})),e.style.zIndex=String(N))}function Rt(){document.querySelectorAll(".card").forEach(e=>{e.addEventListener("pointerdown",()=>le(e),{passive:!0}),e.addEventListener("focusin",()=>le(e),{passive:!0}),e.addEventListener("pointerdown",o=>{if(o.target.closest(".card-close")||o.target.closest("button")||o.target.tagName==="INPUT"||o.target.tagName==="TEXTAREA"||o.target.tagName==="SELECT"||o.target.closest("input")||o.target.closest("textarea")||o.target.closest("select"))return;const t=e.getBoundingClientRect(),n=28;if(!(o.clientX>=t.right-n&&o.clientY>=t.bottom-n)){if(B=e,le(e),je=o.clientX,He=o.clientY,We=e.offsetLeft,Ue=e.offsetTop,j=!1,o.preventDefault(),document.body.style.userSelect="none",o.pointerId&&e.setPointerCapture)try{e.setPointerCapture(o.pointerId)}catch{}document.addEventListener("pointermove",Ge),document.addEventListener("pointerup",Ye)}})})}function Ge(e){if(!B)return;const o=e.clientX-je,t=e.clientY-He;!j&&(Math.abs(o)>De||Math.abs(t)>De)&&(j=!0),j&&(B.style.left=We+o+"px",B.style.top=Ue+t+"px")}function Ye(e){if(B){if(e.pointerId&&B.releasePointerCapture)try{B.releasePointerCapture(e.pointerId)}catch{}B=null,j=!1,document.removeEventListener("pointermove",Ge),document.removeEventListener("pointerup",Ye),document.body.style.userSelect=""}}function Nt(){const e=document.querySelector(".navbar-toggle"),o=document.getElementById("navbar-menu")||document.querySelector(".navbar-menu");if(!e||!o)return;const t=window.matchMedia("(max-width: 1300px)"),n=()=>{const s=t.matches,d=o.classList.contains("open");if(!s){o.classList.remove("open"),e.classList.remove("is-open"),E(o,!1),Q(e,!1);return}E(o,!d),Q(e,d),e.classList.toggle("is-open",d)};n();const a=()=>{if(!t.matches)return;o.classList.add("open"),e.classList.add("is-open"),E(o,!1),Q(e,!0);const s=se(o);s[0]&&s[0].focus()},r=()=>{t.matches&&(o.classList.remove("open"),e.classList.remove("is-open"),E(o,!0),Q(e,!1),e.focus())};e.addEventListener("click",s=>{s.stopPropagation(),o.classList.contains("open")?r():a()}),document.addEventListener("click",s=>{!o.contains(s.target)&&!e.contains(s.target)&&o.classList.contains("open")&&r()}),document.addEventListener("keydown",s=>{s.key==="Escape"&&o.classList.contains("open")&&r()});try{t.addEventListener("change",n)}catch{t.addListener(n)}window.addEventListener("resize",()=>n(),{passive:!0})}function qt(e,o){const t=document.getElementById(e),n=document.getElementById(o);if(!t||!n)return;const a=!n.classList.contains("hidden");t.setAttribute("aria-pressed",a?"true":"false"),E(n,!a);const r=()=>{t.classList.add("pressed"),t.setAttribute("aria-pressed","true"),n.classList.remove("hidden"),E(n,!1),b("open");const c=n.querySelector(".card-close");if(c)c.focus();else{const p=se(n);p[0]&&p[0].focus()}},s=({returnFocus:c=!0}={})=>{t.classList.remove("pressed"),t.setAttribute("aria-pressed","false"),n.classList.add("hidden"),E(n,!0),c&&t.focus()};t.addEventListener("click",()=>{!n.classList.contains("hidden")?s({returnFocus:!1}):r()});const d=n.querySelector(".card-close");d&&d.addEventListener("click",c=>{c.stopPropagation(),b("close"),s({returnFocus:!0})})}function $t(){const e=document.getElementById("loginButton"),o=document.getElementById("loginPopup"),t=document.getElementById("loginPopupClose"),n=document.getElementById("loginForm"),a=document.getElementById("loginFormView"),r=document.getElementById("resetPasswordView"),s=document.getElementById("resetBackBtn"),d=document.getElementById("resetPasswordForm"),c=document.getElementById("resetEmail"),p=document.getElementById("resetRequestBtn"),g=document.getElementById("resetToken"),A=document.getElementById("resetNewPassword"),m=document.getElementById("resetNewPasswordConfirm"),v=document.getElementById("resetSubmitBtn"),S=document.getElementById("loginConnectedView"),L=document.getElementById("loginConnectedMessage"),H=document.getElementById("loginConnectedOk"),Se=document.getElementById("signOutBtn"),I=document.getElementById("loginPassword"),k=document.getElementById("togglePassword"),W=document.getElementById("loginPasswordConfirm"),ke=document.getElementById("confirmPasswordGroup"),K=document.getElementById("togglePasswordConfirm");document.getElementById("rememberMe");const Ce=o.querySelector(".login-options"),Te=o.querySelector(".forgot-password"),Le=document.getElementById("login-title"),Ie=document.getElementById("loginSubtitle"),D=document.getElementById("loginSubmitBtn"),M=document.getElementById("authTabLogin"),O=document.getElementById("authTabSignup"),U=document.getElementById("googleSignInBtn");if(!e||!o)return;let F=!1,V=null,ae="login";const _=i=>{ae=i==="signup"?"signup":"login";const l=ae==="signup";M&&(M.classList.toggle("is-active",!l),M.setAttribute("aria-selected",l?"false":"true")),O&&(O.classList.toggle("is-active",l),O.setAttribute("aria-selected",l?"true":"false")),ke&&ke.classList.toggle("hidden",!l),Ce&&Ce.classList.toggle("hidden",l),Le&&(Le.textContent=l?"Criar conta":"Entrar"),Ie&&(Ie.textContent=l?"Crie sua conta para sincronizar tema e som.":"Acesse sua conta para sincronizar suas configura√ß√µes."),D&&(D.textContent=l?"Criar conta":"Entrar"),I&&I.setAttribute("autocomplete",l?"new-password":"current-password")},re=i=>{if(a&&a.classList.add("hidden"),r&&r.classList.add("hidden"),S&&S.classList.remove("hidden"),L){const l=String(i||"").trim();L.textContent=l?`Voc√™ (${l}) est√° conectado!`:"Voc√™ est√° conectado!"}H?H.focus():t&&t.focus()},Pe=()=>{if(!U)return;if(!Me){U.style.display="none";return}const i=window.google;if(!i?.accounts?.id){setTimeout(Pe,600);return}try{i.accounts.id.initialize({client_id:Me,callback:async l=>{try{const u=!!document.getElementById("rememberMe")?.checked,w=await ft({credential:l.credential,rememberMe:u});b("login");const h=w?.user?.email;h&&(e.textContent=he(h),e.setAttribute("aria-label",`Conta: ${h}`),document.dispatchEvent(new CustomEvent("login-success"))),y("Sess√£o iniciada.","success",2e3),re(h)}catch(u){console.error("Google login failed:",u),y(u?.message||"Falha ao autenticar com Google","error",4e3)}},auto_select:!1,cancel_on_tap_outside:!0}),i.accounts.id.renderButton(U,{type:"icon",shape:"circle",theme:"outline",size:"large"})}catch(l){console.warn("Failed to init Google Identity Services:",l),U.style.display="none"}},G=()=>{S&&S.classList.add("hidden"),r&&r.classList.add("hidden"),a&&a.classList.remove("hidden")},Je=()=>{if(S&&S.classList.add("hidden"),a&&a.classList.add("hidden"),r&&r.classList.remove("hidden"),M&&M.classList.remove("is-active"),O&&O.classList.remove("is-active"),c){const i=x();i&&!c.value&&(c.value=i);try{c.focus()}catch{}}},et=i=>{if(!F||i.key!=="Tab")return;const l=se(o);if(!l.length)return;const u=l[0],w=l[l.length-1],h=document.activeElement;i.shiftKey?(h===u||!o.contains(h))&&(i.preventDefault(),w.focus()):h===w&&(i.preventDefault(),u.focus())},tt=()=>{if(F=!0,V=document.activeElement,o.classList.remove("hidden"),E(o,!1),e.setAttribute("aria-expanded","true"),b("open"),Ke()){const u=x();re(u);return}G(),_("login");const i=document.getElementById("loginEmail"),l=x();i&&l&&!i.value&&(i.value=l),i&&i.focus()},R=()=>{F=!1,o.classList.add("hidden"),E(o,!0),e.setAttribute("aria-expanded","false"),b("close"),I&&(I.type="password"),k&&(k.setAttribute("aria-pressed","false"),k.setAttribute("aria-label",f("showPasswordAria")),k.textContent=f("showPassword")),V&&typeof V.focus=="function"?V.focus():e.focus()};e.addEventListener("click",i=>{i.stopPropagation(),b("click"),F?R():tt()}),t&&t.addEventListener("click",i=>{i.stopPropagation(),R()}),n&&n.addEventListener("submit",async i=>{i.preventDefault();const l=document.getElementById("loginEmail")?.value,u=document.getElementById("loginPassword")?.value,w=document.getElementById("loginPasswordConfirm")?.value,h=!!document.getElementById("rememberMe")?.checked;D&&(D.disabled=!0);try{const P=ae==="signup";if(P&&(!w||String(w)!==String(u||"")))throw new Error("As passwords n√£o coincidem");const z=P?await pt({email:l,password:u}):await mt({email:l,password:u,rememberMe:h});b("login");const Y=z?.user?.email||String(l||"").trim();Y&&(e.textContent=he(Y),e.setAttribute("aria-label",`Conta: ${Y}`),document.dispatchEvent(new CustomEvent("login-success"))),y("Sess√£o iniciada.","success",2e3);const ie=(()=>{try{return localStorage.getItem("theme")}catch{return null}})(),Be=(()=>{try{return localStorage.getItem("soundMuted")==="true"}catch{return}})(),X={};if((ie==="dark"||ie==="light")&&(X.theme=ie),typeof Be<"u"&&(X.soundMuted=Be),Object.keys(X).length)try{await yt(X)}catch{}re(Y)}catch(P){console.error("Login failed:",P),y(P?.message||"Falha ao iniciar sess√£o","error",4e3)}finally{D&&(D.disabled=!1)}}),Te&&Te.addEventListener("click",i=>{i.preventDefault(),i.stopPropagation(),Je()}),s&&s.addEventListener("click",i=>{i.preventDefault(),i.stopPropagation(),G(),_("login"),document.getElementById("loginEmail")?.focus()}),p&&p.addEventListener("click",async i=>{i.preventDefault(),i.stopPropagation();const l=c?.value;if(!l){y("Email √© obrigat√≥rio","warning",2500),c?.focus();return}p&&(p.disabled=!0);try{const u=await gt(l);y(u?.message||"Pedido enviado.","success",3500);const w=u?.dev?.token;w&&g&&!g.value?(g.value=w,y("Token preenchido automaticamente (modo dev).","info",2500),A?.focus()):g?.focus()}catch(u){console.error("Request reset failed:",u),y(u?.message||"Falha ao pedir token","error",3500)}finally{p&&(p.disabled=!1)}}),d&&d.addEventListener("submit",async i=>{i.preventDefault();const l=g?.value,u=A?.value,w=m?.value;if(!l){y("Token √© obrigat√≥rio","warning",2500),g?.focus();return}if(!u||String(u).length<8){y("A nova password deve ter pelo menos 8 caracteres","warning",3e3),A?.focus();return}if(String(u)!==String(w||"")){y("As passwords n√£o coincidem","warning",3e3),m?.focus();return}v&&(v.disabled=!0);try{const h=await ht({token:l,password:u});y(h?.message||"Password atualizada.","success",3500);const P=String(c?.value||"").trim();G(),_("login");const z=document.getElementById("loginEmail");z&&P&&!z.value&&(z.value=P),document.getElementById("loginPassword")?.focus(),g&&(g.value=""),A&&(A.value=""),m&&(m.value="")}catch(h){console.error("Reset password failed:",h),y(h?.message||"Falha ao redefinir password","error",3500)}finally{v&&(v.disabled=!1)}}),k&&I&&k.addEventListener("click",i=>{i.stopPropagation();const u=!(I.type==="text");I.type=u?"text":"password",k.setAttribute("aria-pressed",u?"true":"false"),k.setAttribute("aria-label",f(u?"hidePasswordAria":"showPasswordAria")),k.textContent=f(u?"hidePassword":"showPassword");try{I.focus()}catch{}}),K&&W&&K.addEventListener("click",i=>{i.stopPropagation();const u=!(W.type==="text");W.type=u?"text":"password",K.setAttribute("aria-pressed",u?"true":"false"),K.setAttribute("aria-label",f(u?"hidePasswordConfirmAria":"showPasswordConfirmAria")),K.textContent=f(u?"hidePassword":"showPassword");try{W.focus()}catch{}}),M&&M.addEventListener("click",i=>{i.stopPropagation(),_("login"),document.getElementById("loginEmail")?.focus()}),O&&O.addEventListener("click",i=>{i.stopPropagation(),_("signup"),document.getElementById("loginEmail")?.focus()}),H&&H.addEventListener("click",i=>{i.stopPropagation(),R()}),Se&&Se.addEventListener("click",i=>{i.stopPropagation(),$e(),e.textContent=f("login"),e.setAttribute("aria-label",f("login")),y("Sess√£o terminada.","info",2e3),G(),_("login"),R()}),document.addEventListener("click",i=>{F&&!o.contains(i.target)&&!e.contains(i.target)&&R()}),document.addEventListener("keydown",i=>{i.key==="Escape"&&F&&R()}),document.addEventListener("keydown",et),Pe()}let C=null;function vt(){return C||(C=document.createElement("div"),C.id="notification-container",C.setAttribute("role","alert"),C.setAttribute("aria-live","polite"),C.style.cssText=`
    position: fixed;
    bottom: max(80px, calc(env(safe-area-inset-bottom, 0) + 92px));
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    z-index: 9999;
    pointer-events: none;
  `,document.body.appendChild(C),C)}const bt=2e3;let Xe=!0;setTimeout(()=>{Xe=!1},bt);const Fe={success:"var(--success)",warning:"var(--warning)",error:"var(--danger)",info:"var(--primary)"};function we(e,{direction:o="down",immediate:t=!1}={}){if(!e||e.dataset.dismissed==="true")return;e.dataset.dismissed="true";const n=()=>e.remove();if(t)return n();const a=o==="left"?-1:o==="right"?1:0,r=a?`translate3d(${a*120}%, 0, 0)`:"translate3d(0, 20px, 0)";e.style.transition="transform 0.22s ease, opacity 0.22s ease",e.style.opacity="0",e.style.transform=r,setTimeout(n,240)}function At(e,{onDismiss:o}={}){if(!e)return;let t=0,n=0,a=0,r=!1,s=null,d=!1;const c=m=>{if(!(m.pointerType==="mouse"&&m.button!==0)){s=m.pointerId,d=!1,r=!1,t=m.clientX,n=m.clientY,a=m.clientX,e.style.willChange="transform, opacity";try{e.setPointerCapture(s)}catch{}}},p=m=>{if(s===null||m.pointerId!==s)return;const v=m.clientX-t,S=m.clientY-n;if(a=m.clientX,!r){if(Math.abs(v)<8||Math.abs(v)<=Math.abs(S)+6)return;r=!0}d=!0,e.style.transition="none",e.style.transform=`translate3d(${v}px, 0, 0)`;const L=Math.min(.65,Math.abs(v)/320);e.style.opacity=String(1-L),m.preventDefault()},g=m=>{if(s===null||m.pointerId!==s)return;try{e.releasePointerCapture(s)}catch{}if(s=null,!r)return;const v=a-t;if(Math.abs(v)>90){const L=v<0?"left":"right";o?.(L),we(e,{direction:L});return}e.style.transition="transform 0.2s ease, opacity 0.2s ease",e.style.opacity="1",e.style.transform="translate3d(0, 0, 0)",setTimeout(()=>{e.style.willChange=""},220)},A=()=>{s=null,e.style.transition="transform 0.2s ease, opacity 0.2s ease",e.style.opacity="1",e.style.transform="translate3d(0, 0, 0)",setTimeout(()=>{e.style.willChange=""},220)};e.addEventListener("pointerdown",c),e.addEventListener("pointermove",p),e.addEventListener("pointerup",g),e.addEventListener("pointercancel",A),e.addEventListener("click",m=>{d&&(m.preventDefault(),m.stopPropagation())},{capture:!0})}function y(e,o="success",t=3e3,n=!0,a={}){n&&!Xe&&b("notification");const r=vt(),s=document.createElement("div"),d=a&&typeof a=="object"?a:{};s.className=`notification notification-${o}`,s.textContent=e,s.setAttribute("role","alert"),s.dataset.dismissed="false",s.style.cssText=`
    background-color: ${Fe[o]||Fe.success};
    color: white;
    padding: 0.75rem 1.5rem;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    opacity: 0;
    transform: translate3d(0, 20px, 0);
    transition: opacity 0.3s ease, transform 0.3s ease;
    pointer-events: auto;
    max-width: min(92vw, 520px);
    text-align: center;
    touch-action: pan-y;
  `,r.appendChild(s);let c=null;const p=()=>{t<=0||(c=setTimeout(()=>{we(s,{direction:"down"})},t))},g=()=>{c&&clearTimeout(c),c=null};At(s,{onDismiss:()=>g()}),requestAnimationFrame(()=>{s.style.opacity="1",s.style.transform="translate3d(0, 0, 0)"}),s.addEventListener("click",async A=>{A.stopPropagation(),g();try{typeof d.onClick=="function"&&await d.onClick()}finally{(typeof d.dismissOnClick=="boolean"?d.dismissOnClick:!0)&&we(s,{direction:"down"})}}),p()}function Kt(e,o="success",t=5e3){y(e,o,t,!1)}function zt(){document.addEventListener("keydown",e=>{if(!(e.target&&(e.target.tagName==="INPUT"||e.target.tagName==="TEXTAREA"||e.target.tagName==="SELECT")&&e.key!=="Escape")){if((e.ctrlKey||e.metaKey)&&e.shiftKey&&e.key==="P"&&(e.preventDefault(),q("pomodoroButton","pomodoroCard")),(e.ctrlKey||e.metaKey)&&e.shiftKey&&e.key==="T"&&(e.preventDefault(),q("timerButton","timerCard")),(e.ctrlKey||e.metaKey)&&e.shiftKey&&e.key==="L"&&(e.preventDefault(),q("tasklistButton","tasklistCard")),(e.ctrlKey||e.metaKey)&&e.shiftKey&&e.key==="C"&&(e.preventDefault(),q("countdownButton","countdownCard")),(e.ctrlKey||e.metaKey)&&e.shiftKey&&e.key==="W"&&(e.preventDefault(),q("worldClockButton","worldClockCard")),(e.ctrlKey||e.metaKey)&&e.shiftKey&&e.key==="S"&&(e.preventDefault(),q("stopwatchButton","stopwatchCard")),(e.ctrlKey||e.metaKey)&&e.shiftKey&&e.key==="?"&&(e.preventDefault(),Qe()),(e.ctrlKey||e.metaKey)&&e.shiftKey&&e.key==="D"){e.preventDefault();const t=document.querySelector("theme-toggle");t&&typeof t.toggleTheme=="function"&&t.toggleTheme()}if(e.key==="Escape"){const t=document.getElementById("shortcutsModal");t&&!t.classList.contains("hidden")?(Ze(),document.getElementById("shortcutsBtn")?.focus()):St()}}})}function Qe(){const e=document.getElementById("shortcutsModal");e&&(e.classList.remove("hidden"),e.setAttribute("aria-hidden","false"),document.getElementById("shortcutsClose")?.focus())}function Ze(){const e=document.getElementById("shortcutsModal");e&&(e.classList.add("hidden"),e.setAttribute("aria-hidden","true"))}function q(e,o){const t=document.getElementById(e),n=document.getElementById(o);!t||!n||t.click()}function St(){const e=document.querySelectorAll(".card:not(.hidden)"),o=document.querySelectorAll("#buttonContainer button.pressed");e.forEach(t=>{t.classList.add("hidden"),E(t,!0)}),o.forEach(t=>{t.classList.remove("pressed"),t.setAttribute("aria-pressed","false")})}function jt(){const e=document.querySelectorAll(".navbar-dropdown-btn"),o=document.querySelectorAll(".navbar-dropdown");let t=null;o.forEach(s=>{E(s,s.classList.contains("hidden"))});const n=({returnFocus:s=!1}={})=>{o.forEach(d=>{d.classList.add("hidden"),E(d,!0)}),e.forEach(d=>{d.classList.remove("active"),d.setAttribute("aria-expanded","false")}),s&&t&&(t.focus(),t=null)},a=s=>{const d=s.getAttribute("data-dropdown"),c=document.getElementById(`dropdown-${d}`);if(!c)return;const p=!c.classList.contains("hidden");if(n({returnFocus:!1}),!p){c.classList.remove("hidden"),s.classList.add("active"),s.setAttribute("aria-expanded","true"),E(c,!1),t=s,d==="configuracoes"&&ut("sidebarStats");const g=se(c);g[0]&&g[0].focus()}};e.forEach(s=>{s.addEventListener("click",d=>{d.stopPropagation(),a(s),b("open")})}),document.querySelectorAll(".dropdown-close").forEach(s=>{s.addEventListener("click",d=>{d.stopPropagation(),b("close");const c=s.closest(".navbar-dropdown"),p=c?document.querySelector(`.navbar-dropdown-btn[data-dropdown="${c.id.replace("dropdown-","")}"]`):null;c&&(c.classList.add("hidden"),E(c,!0)),p&&(p.classList.remove("active"),p.setAttribute("aria-expanded","false"),p.focus())})}),document.addEventListener("click",s=>{!s.target.closest(".navbar-dropdown")&&!s.target.closest(".navbar-dropdown-btn")&&n({returnFocus:!1})}),document.addEventListener("keydown",s=>{s.key==="Escape"&&n({returnFocus:!0})})}function Ht(){const e=document.getElementById("focusModeBtn"),o=document.getElementById("focusModeExit"),t=document.querySelector(".navbar"),n=document.getElementById("leftSidebar"),a=document.getElementById("buttonContainer"),r=document.querySelector("footer");if(!e||!t)return;const s=()=>{document.body.classList.remove("focus-mode"),t?.classList.remove("hidden"),n?.classList.remove("hidden"),a&&a.classList.remove("hidden"),r?.classList.remove("hidden"),e?.setAttribute("aria-pressed","false"),e.textContent="Modo foco",o?.classList.add("hidden")},d=()=>{document.body.classList.add("focus-mode"),t?.classList.add("hidden"),n?.classList.add("hidden"),a&&a.classList.add("hidden"),r?.classList.add("hidden"),e.setAttribute("aria-pressed","true"),e.textContent="Modo foco (ativo)",o?.classList.remove("hidden")};e.addEventListener("click",()=>{e.getAttribute("aria-pressed")==="true"?s():d()}),o?.addEventListener("click",s)}function Wt(){const e=document.getElementById("shortcutsModal"),o=document.getElementById("shortcutsBtn"),t=document.getElementById("shortcutsClose");if(!e||!t)return;const n=()=>{Ze(),o?.focus()};o?.addEventListener("click",()=>Qe()),t.addEventListener("click",n),e.addEventListener("click",a=>{a.target===e&&n()})}export{qt as A,Ae as B,ut as C,Lt as a,Kt as b,Ot as c,Bt as d,Rt as e,he as f,x as g,Nt as h,Ke as i,$t as j,jt as k,zt as l,Ht as m,Wt as n,Dt as o,b as p,xt as q,Mt as r,y as s,f as t,Tt as u,Ft as v,_t as w,Pt as x,It as y,yt as z};
