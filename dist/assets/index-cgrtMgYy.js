import{p as c,r as K,a as _,t as f,b as D,s as l,g as Y,f as V,i as T,c as G,d as J,e as X,h as Z,j as Q,k as tt,l as et,m as nt,n as it,o as st,q as ot,u as at,v as rt,w as lt,x as z,y as ct,z as M,A as g,B as I,C as dt}from"./utils-CU6JuVaF.js";import{b as mt,d as ut,c as k,a as S,s as R,r as B,e as ht,f as pt,i as ft,h as gt,j as wt,k as yt,l as vt,m as x,n as Et,o as Tt,p as It}from"./pwa-Bvh0rDGd.js";import"./vendor-Dob3nYDb.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function e(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=e(i);fetch(i.href,o)}})();const kt="modulepreload",St=function(s){return"/"+s},$={},Bt=function(t,e,n){let i=Promise.resolve();if(e&&e.length>0){let a=function(m){return Promise.all(m.map(u=>Promise.resolve(u).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const r=document.querySelector("meta[property=csp-nonce]"),d=r?.nonce||r?.getAttribute("nonce");i=a(e.map(m=>{if(m=St(m),m in $)return;$[m]=!0;const u=m.endsWith(".css"),h=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${h}`))return;const p=document.createElement("link");if(p.rel=u?"stylesheet":kt,u||(p.as="script"),p.crossOrigin="",p.href=m,d&&p.setAttribute("nonce",d),document.head.appendChild(p),u)return new Promise((H,j)=>{p.addEventListener("load",H),p.addEventListener("error",()=>j(new Error(`Unable to preload CSS for ${m}`)))})}))}function o(a){const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=a,window.dispatchEvent(r),!r.defaultPrevented)throw a}return i.then(a=>{for(const r of a||[])r.status==="rejected"&&o(r.reason);return t().catch(o)})},bt=1e3;function Lt(s,t){if(!(!("Notification"in window)||Notification.permission!=="granted"))try{new Notification(s,{body:t,icon:"/SB_B.png"})}catch{}}function At(){"Notification"in window&&Notification.permission==="default"&&Notification.requestPermission().catch(()=>{})}const y=25,b=5,L=60,A=30;class Ct{constructor(){this.workTime=y,this.breakTime=b,this.timeLeft=y*60,this.isRunning=!1,this.isBreak=!1,this.interval=null,this.elements={},this.init()}init(){this.elements.workInput=document.getElementById("pomodoroWork"),this.elements.breakInput=document.getElementById("pomodoroBreak"),this.elements.startBtn=document.getElementById("pomodoroStart"),this.elements.stopBtn=document.getElementById("pomodoroStop"),this.elements.resetBtn=document.getElementById("pomodoroReset"),this.elements.display=document.getElementById("pomodoroDisplay"),this.elements.workInput&&this.elements.workInput.addEventListener("change",t=>{const e=parseInt(t.target.value,10);isNaN(e)||e<=0?(this.workTime=y,t.target.value=y):e>L?(this.workTime=L,t.target.value=L):this.workTime=e,this.isRunning||this.reset()}),this.elements.breakInput&&this.elements.breakInput.addEventListener("change",t=>{const e=parseInt(t.target.value,10);isNaN(e)||e<=0?(this.breakTime=b,t.target.value=b):e>A?(this.breakTime=A,t.target.value=A):this.breakTime=e}),this.elements.startBtn&&this.elements.startBtn.addEventListener("click",t=>{t.stopPropagation(),this.start()}),this.elements.stopBtn&&this.elements.stopBtn.addEventListener("click",t=>{t.stopPropagation(),this.stop()}),this.elements.resetBtn&&this.elements.resetBtn.addEventListener("click",t=>{t.stopPropagation(),this.reset()}),this.updateDisplay()}start(){this.isRunning||(At(),this.isRunning=!0,c("click"),this.interval=setInterval(()=>{if(this.timeLeft--,this.timeLeft<=0){const t=this.isBreak;this.isBreak=!this.isBreak,t||K(this.workTime),this.timeLeft=(this.isBreak?this.breakTime:this.workTime)*60,this.updateDisplay(),_("alarm");const e=this.isBreak?f("pomoBreakTitle"):f("pomoWorkTitle"),n=this.isBreak?`${f("pomoReminderWater")} ‚Ä¢ ${f("pomoReminderStretch")} ‚Ä¢ ${f("pomoReminderEat")}`:f("pomoWorkBody");Lt(e,n);const i=this.isBreak?f("pomoBreakWellness"):f("pomoWorkToast");D(i,"info",7e3)}else this.updateDisplay()},bt))}stop(){this.isRunning=!1,this.interval&&(clearInterval(this.interval),this.interval=null),c("reset")}reset(){this.stop(),this.timeLeft=this.workTime*60,this.isBreak=!1,c("reset"),this.updateDisplay()}updateDisplay(){const t=this.elements.display;if(!t)return;const e=Math.floor(this.timeLeft/60),n=this.timeLeft%60;t.textContent=`${String(e).padStart(2,"0")}:${String(n).padStart(2,"0")}`}destroy(){this.stop()}}function Nt(s,t){if(!(!("Notification"in window)||Notification.permission!=="granted"))try{new Notification(s,{body:t,icon:"/SB_B.png"})}catch{}}const Pt=1e3;class Ft{constructor(){this.totalSeconds=0,this.timeLeft=0,this.isRunning=!1,this.interval=null,this.elements={},this.init()}init(){this.elements.startBtn=document.getElementById("timerStart"),this.elements.stopBtn=document.getElementById("timerStop"),this.elements.resetBtn=document.getElementById("timerReset"),this.elements.minInput=document.getElementById("timerMinutes"),this.elements.secInput=document.getElementById("timerSeconds"),this.elements.display=document.getElementById("timerDisplay"),this.elements.startBtn&&this.elements.startBtn.addEventListener("click",t=>{t.stopPropagation(),this.start()}),this.elements.stopBtn&&this.elements.stopBtn.addEventListener("click",t=>{t.stopPropagation(),this.stop()}),this.elements.resetBtn&&this.elements.resetBtn.addEventListener("click",t=>{t.stopPropagation(),this.reset()}),this.elements.minInput&&this.elements.minInput.addEventListener("change",()=>this.updateTotal()),this.elements.secInput&&this.elements.secInput.addEventListener("change",()=>this.updateTotal()),this.updateTotal()}updateTotal(){const t=this.elements.minInput,e=this.elements.secInput,n=t?.value?parseInt(t.value,10):0,i=e?.value?parseInt(e.value,10):0;this.totalSeconds=(isNaN(n)?0:n)*60+(isNaN(i)?0:i),this.timeLeft=this.totalSeconds,this.updateDisplay()}start(){this.isRunning||this.timeLeft<=0||("Notification"in window&&Notification.permission==="default"&&Notification.requestPermission().catch(()=>{}),this.isRunning=!0,c("click"),this.interval=setInterval(()=>{this.timeLeft--,this.updateDisplay(),this.timeLeft<=0&&(this.stop(),_("alarm"),Nt("Timer finished!","O teu temporizador terminou."),D("Timer finished!","success",5e3))},Pt))}stop(){this.isRunning=!1,this.interval&&(clearInterval(this.interval),this.interval=null),c("reset")}reset(){this.stop(),this.timeLeft=this.totalSeconds,c("reset"),this.updateDisplay()}updateDisplay(){const t=this.elements.display;if(!t)return;const e=Math.floor(this.timeLeft/60),n=this.timeLeft%60;t.textContent=`${String(e).padStart(2,"0")}:${String(n).padStart(2,"0")}`}destroy(){this.stop()}}const _t=10,v=6e4,E=1e3,O=100;class Dt{constructor(){this.startTime=0,this.elapsedTime=0,this.isRunning=!1,this.interval=null,this.laps=[],this.elements={},this.init()}init(){this.elements.startBtn=document.getElementById("stopwatchStart"),this.elements.stopBtn=document.getElementById("stopwatchStop"),this.elements.resetBtn=document.getElementById("stopwatchReset"),this.elements.lapBtn=document.getElementById("stopwatchLap"),this.elements.display=document.getElementById("stopwatchDisplay"),this.elements.lapsList=document.getElementById("stopwatchLaps"),this.elements.startBtn&&this.elements.startBtn.addEventListener("click",t=>{t.stopPropagation(),this.start()}),this.elements.stopBtn&&this.elements.stopBtn.addEventListener("click",t=>{t.stopPropagation(),this.stop()}),this.elements.resetBtn&&this.elements.resetBtn.addEventListener("click",t=>{t.stopPropagation(),this.reset()}),this.elements.lapBtn&&this.elements.lapBtn.addEventListener("click",t=>{t.stopPropagation(),this.lap()}),this.updateDisplay()}start(){this.isRunning||(this.isRunning=!0,this.startTime=Date.now()-this.elapsedTime,c("click"),this.interval=setInterval(()=>{this.elapsedTime=Date.now()-this.startTime,this.updateDisplay()},_t))}stop(){this.isRunning=!1,this.interval&&(clearInterval(this.interval),this.interval=null),c("reset")}reset(){this.stop(),this.elapsedTime=0,this.laps=[],this.updateDisplay(),this.renderLaps()}lap(){if(!this.isRunning)return;const t=this.elapsedTime,e=this.laps.length+1;this.laps.push({number:e,time:t}),c("click"),this.renderLaps()}updateDisplay(){const t=this.elements.display;if(!t)return;const e=this.elapsedTime,n=Math.floor(e/v),i=Math.floor(e%v/E),o=Math.floor(e%E/O);t.textContent=`${String(n).padStart(2,"0")}:${String(i).padStart(2,"0")}.${String(o).padStart(2,"0")}`}formatLapTime(t){const e=Math.floor(t/v),n=Math.floor(t%v/E),i=Math.floor(t%E/O);return`${String(e).padStart(2,"0")}:${String(n).padStart(2,"0")}.${String(i).padStart(2,"0")}`}renderLaps(){const t=this.elements.lapsList;if(!t)return;if(this.laps.length===0){t.innerHTML="";return}const e=document.createDocumentFragment();this.laps.forEach((n,i)=>{const o=i===0?n.time:n.time-this.laps[i-1].time,a=document.createElement("li");a.className="lap-item",a.innerHTML=`
        <span class="lap-number">Lap ${n.number}</span>
        <span class="lap-time">${this.formatLapTime(n.time)}</span>
        <span class="lap-delta">+${this.formatLapTime(o)}</span>
      `,e.appendChild(a)}),t.innerHTML="",t.appendChild(e)}destroy(){this.stop()}}const zt=1e3,C="countdowns",U="countdownTargetDate",q="countdownActive";function Mt(s,t){try{return s?JSON.parse(s):t}catch{return t}}function Rt(s){const t=Math.max(0,s),e=Math.floor(t/(1e3*60*60*24)),n=Math.floor(t%(1e3*60*60*24)/(1e3*60*60)),i=Math.floor(t%(1e3*60*60)/(1e3*60)),o=Math.floor(t%(1e3*60)/1e3);return`${String(e).padStart(2,"0")}:${String(n).padStart(2,"0")}:${String(i).padStart(2,"0")}:${String(o).padStart(2,"0")}`}function W(){return`${Date.now()}_${Math.random().toString(16).slice(2)}`}class xt{constructor(){this.countdowns=[],this.interval=null,this.elements={},this.init()}init(){this.elements.addBtn=document.getElementById("countdownAdd"),this.elements.resetAllBtn=document.getElementById("countdownResetAll"),this.elements.dateInput=document.getElementById("countdownDate"),this.elements.labelInput=document.getElementById("countdownLabel"),this.elements.list=document.getElementById("countdownList"),this.load(),this.elements.addBtn&&this.elements.addBtn.addEventListener("click",t=>{t.stopPropagation(),this.addCountdown()}),this.elements.resetAllBtn&&this.elements.resetAllBtn.addEventListener("click",t=>{t.stopPropagation(),this.resetAll()}),this.elements.list&&this.elements.list.addEventListener("click",t=>{const e=t.target.closest('[data-action="remove-countdown"]');if(!e)return;const n=e.getAttribute("data-id");n&&this.removeCountdown(n)}),this.render(),this.startLoop()}load(){try{const n=localStorage.getItem(U);if(n){const i=localStorage.getItem(q)==="true",o=W();this.countdowns=[{id:o,label:"Countdown",targetISO:n,active:!!i,createdAt:Date.now()}],localStorage.removeItem(U),localStorage.removeItem(q),localStorage.setItem(C,JSON.stringify(this.countdowns))}}catch{}try{const n=localStorage.getItem(C),i=Mt(n,[]);this.countdowns=Array.isArray(i)?i:[]}catch{this.countdowns=[]}const t=Date.now();let e=!1;this.countdowns.forEach(n=>{if(n?.active){const i=new Date(n.targetISO).getTime();(!Number.isFinite(i)||i<=t)&&(n.active=!1,n.completedAt=t,e=!0)}}),e&&this.save()}save(){try{localStorage.setItem(C,JSON.stringify(this.countdowns))}catch{}}addCountdown(){const t=this.elements.dateInput;if(!t)return;const e=t.value;if(!e){l("Por favor, selecione uma data e hora","warning");return}const n=new Date(e),i=n.getTime();if(!Number.isFinite(i)){l("Data inv√°lida. Tenta novamente.","warning");return}const o=(this.elements.labelInput?.value||"").trim(),a=W();this.countdowns.push({id:a,label:o||"Countdown",targetISO:n.toISOString(),active:!0,createdAt:Date.now()}),this.elements.labelInput&&(this.elements.labelInput.value=""),t.value="",this.save(),this.render(),c("open")}removeCountdown(t){const e=this.countdowns.length;this.countdowns=this.countdowns.filter(n=>n.id!==t),this.countdowns.length!==e&&(this.save(),this.render(),c("close"))}resetAll(){this.countdowns.length&&(this.countdowns=[],this.save(),this.render(),c("reset"))}startLoop(){this.interval||(this.interval=setInterval(()=>{this.tick()},zt))}tick(){if(!this.countdowns.length)return;const t=Date.now();let e=!1;for(const n of this.countdowns){if(!n.active)continue;const i=new Date(n.targetISO).getTime();if(!Number.isFinite(i)){n.active=!1,n.completedAt=t,e=!0;continue}if(i<=t){n.active=!1,n.completedAt=t,e=!0,_("alarm");const o=n.label||"A contagem regressiva";D(`${o} terminou!`,"success",5e3)}}e&&this.save(),this.render()}render(){const t=this.elements.list;if(!t)return;if(!this.countdowns.length){t.innerHTML='<div class="empty-message">Nenhum countdown ainda. Adiciona um acima!</div>';return}const e=Date.now(),n=document.createDocumentFragment();for(const i of this.countdowns){const o=new Date(i.targetISO).getTime(),a=Number.isFinite(o)?o-e:0,r=i.active?Rt(a):"00:00:00:00",d=document.createElement("div");d.className=`countdown-item ${i.active?"":"is-done"}`.trim(),d.setAttribute("role","listitem"),d.dataset.id=i.id;const m=document.createElement("span");m.className="cd-name",m.textContent=i.label||"Countdown";const u=document.createElement("span");u.className="cd-time",u.setAttribute("aria-label","Tempo restante"),u.textContent=r;const h=document.createElement("button");h.className="delete-btn",h.type="button",h.setAttribute("data-action","remove-countdown"),h.setAttribute("data-id",i.id),h.setAttribute("aria-label",`Remover ${i.label||"countdown"}`),h.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16"><path fill="currentColor" d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>',d.appendChild(m),d.appendChild(u),d.appendChild(h),n.appendChild(d)}t.innerHTML="",t.appendChild(n)}destroy(){this.interval&&(clearInterval(this.interval),this.interval=null)}}const w=mt("/api/tasks");class $t{constructor(){this.tasks=[],this.inFlight=new Set,this.init()}init(){const t=document.getElementById("addTaskBtn"),e=document.getElementById("taskInput");t&&t.addEventListener("click",n=>{n.stopPropagation(),this.addTask()}),e&&e.addEventListener("keypress",n=>{n.key==="Enter"&&(n.stopPropagation(),this.addTask())}),this.loadTasksFromApi(),window.addEventListener("pwa-synced",()=>this.loadTasksFromApi())}async loadTasksFromApi(){try{const t=await ut();this.tasks=(t||[]).map(e=>({id:e._id,text:e.text,done:!!e.done,createdAt:e.createdAt,completedAt:e.completedAt??null})),this.render()}catch(t){console.warn("Falha ao carregar tarefas (API + offline):",t),this.tasks=[],this.render(),l("N√£o foi poss√≠vel carregar as tarefas","warning")}}async addTask(){const t=document.getElementById("taskInput");if(!t)return;const e=t.value.trim();if(!e){l("Por favor, insira uma tarefa","warning");return}if(e.length>200){l("A tarefa n√£o pode ter mais de 200 caracteres","warning");return}if(this.tasks.some(i=>i.text.toLowerCase()===e.toLowerCase())){l("Esta tarefa j√° existe","warning");return}try{const i=await k(w,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:e})});if(!i.ok)throw new Error(`Erro HTTP ${i.status}`);const o=await i.json(),a={id:o._id,text:o.text,done:!!o.done,createdAt:o.createdAt,completedAt:o.completedAt??null};this.tasks.push(a),t.value="",this.render(),c("task_add")}catch(i){if(!(!navigator.onLine||i.message.includes("Failed to fetch")||i.message.includes("NetworkError"))){l("Erro ao adicionar tarefa: "+i.message,"error");return}const a=`temp-${Date.now()}`,r={_id:a,text:e,done:!1,createdAt:new Date().toISOString(),completedAt:null};this.tasks.push({id:a,text:r.text,done:!1,createdAt:r.createdAt,completedAt:null}),t.value="",this.render();try{await S({type:"POST",url:w,body:{text:e}}),await R("tasks",r),await B()}catch(d){console.error("Failed to queue offline task:",d)}c("task_add"),l("Tarefa guardada localmente; ser√° sincronizada quando houver liga√ß√£o.","info")}}async deleteTask(t){const e=[...this.tasks];this.tasks=this.tasks.filter(n=>n.id!==t),this.render();try{const n=await k(`${w}/${t}`,{method:"DELETE"});if(!n.ok)throw new Error(`Erro HTTP ${n.status}`);c("task_delete")}catch{try{await S({type:"DELETE",url:`${w}/${t}`,id:t}),await ht("tasks",t),await B()}catch(i){console.error("Failed to queue offline delete:",i),this.tasks=e,this.render()}c("task_delete"),l("Elimina√ß√£o ser√° sincronizada quando houver liga√ß√£o.","info")}}async toggleTask(t){const e=this.tasks.find(n=>n.id===t);if(e&&!this.inFlight.has(t)){e.done=!e.done,e.completedAt=e.done?new Date().toISOString():null,this.render(),this.inFlight.add(t);try{const n=await k(`${w}/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({done:e.done})});if(!n.ok)throw new Error(`Erro HTTP ${n.status}`);const i=await n.json();e.done=!!i.done,e.completedAt=i.completedAt??null,c("task_toggle")}catch{await S({type:"PUT",url:`${w}/${t}`,body:{done:e.done}}),await R("tasks",{_id:t,text:e.text,done:e.done,createdAt:e.createdAt,completedAt:e.completedAt}),await B(),c("task_toggle"),l("Altera√ß√£o guardada localmente; ser√° sincronizada quando houver liga√ß√£o.","info")}finally{this.inFlight.delete(t),this.render()}}}render(){const t=document.getElementById("taskList");if(!t)return;const e=document.createDocumentFragment();if(this.tasks.length)this.tasks.forEach(n=>{const i=document.createElement("li");i.className=`task-item ${n.done?"done":""}`,i.setAttribute("role","listitem");const o=document.createElement("input");o.type="checkbox",o.checked=n.done,o.setAttribute("aria-label",`Marcar tarefa "${n.text}" como ${n.done?"n√£o conclu√≠da":"conclu√≠da"}`),o.addEventListener("change",()=>this.toggleTask(n.id));const a=document.createElement("span");a.textContent=n.text;const r=document.createElement("button");r.className="delete-btn",r.textContent="√ó",r.setAttribute("aria-label",`Eliminar tarefa "${n.text}"`),r.addEventListener("click",()=>this.deleteTask(n.id)),i.appendChild(o),i.appendChild(a),i.appendChild(r),e.appendChild(i)});else{const n=document.createElement("li");n.className="empty-message",n.textContent="Nenhuma tarefa ainda. Adicione uma acima!",e.appendChild(n)}t.innerHTML="",t.appendChild(e)}}class Ot{constructor(){this.timezones=[],this.timeFormatters=new Map,this.lastUpdate=0,this.updateInterval=1e3,this.animationFrameId=null,this.isRunning=!1,this.init()}init(){try{const n=localStorage.getItem("worldClockTimezones");this.timezones=n?JSON.parse(n):[]}catch(n){console.warn("Failed to load timezones from localStorage:",n),this.timezones=[]}this.timezones.forEach(({tz:n})=>this.getFormatter(n));const t=document.getElementById("addTimezoneBtn"),e=document.getElementById("timezoneList");t&&t.addEventListener("click",n=>{n.stopPropagation(),this.addTimezone()}),e&&e.addEventListener("click",n=>{const i=n.target.closest('[data-action="remove-tz"]');if(i){const o=i.dataset.tz;this.removeTimezone(o)}}),this.startUpdateLoop(),this.render()}getFormatter(t){return this.timeFormatters.has(t)||this.timeFormatters.set(t,new Intl.DateTimeFormat("en-US",{timeZone:t,hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1})),this.timeFormatters.get(t)}startUpdateLoop(){if(this.isRunning)return;this.isRunning=!0;const t=()=>{const e=Date.now();e-this.lastUpdate>=this.updateInterval&&(this.render(),this.lastUpdate=e),this.animationFrameId=requestAnimationFrame(t)};this.animationFrameId=requestAnimationFrame(t)}stopUpdateLoop(){this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null),this.isRunning=!1}addTimezone(){const t=document.getElementById("timezoneSelect");if(!t)return;const e=t.value,n=t.options[t.selectedIndex].text;if(!e){l("Por favor, selecione um fuso hor√°rio","warning");return}if(this.timezones.find(o=>o.tz===e)){l("Este fuso hor√°rio j√° est√° na lista","warning");return}this.timezones.push({tz:e,name:n}),this.getFormatter(e),this.save(),this.render(),c("timezone_add")}removeTimezone(t){const e=this.timezones.findIndex(n=>n.tz===t);e!==-1&&(this.timezones.splice(e,1),this.timeFormatters.delete(t),this.save(),this.render(),c("timezone_remove"))}save(){try{localStorage.setItem("worldClockTimezones",JSON.stringify(this.timezones))}catch(t){console.warn("Failed to save timezones to localStorage:",t),l("Falha ao guardar fusos hor√°rios. O armazenamento pode estar cheio.","error")}}render(){const t=document.getElementById("timezoneList");if(!t)return;if(!(this.timezones.length>0)){t.innerHTML='<div class="empty-message">Nenhum fuso hor√°rio adicionado. Selecione um acima!</div>';return}const n=document.createDocumentFragment();this.timezones.forEach(({tz:i,name:o})=>{let a;try{a=this.getFormatter(i).format(new Date)}catch{a="--:--:--"}const r=document.createElement("div");r.className="timezone-item",r.setAttribute("role","listitem"),r.dataset.tz=i,r.innerHTML=`
        <span class="tz-name">${o}</span>
        <span class="tz-time" aria-label="Hora em ${o}">${a}</span>
        <button class="delete-btn" aria-label="Remover ${o}" data-action="remove-tz" data-tz="${i}">
          <svg viewBox="0 0 24 24" width="16" height="16"><path fill="currentColor" d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      `,n.appendChild(r)}),t.innerHTML="",t.appendChild(n)}destroy(){this.stopUpdateLoop(),this.timeFormatters.clear()}}const Ut={pomodoroCard:null,timerCard:300,tasklistCard:-300,countdownCard:null,worldClockCard:600};async function qt(){const s=document.getElementById("pushNotifyBtn");if(!s)return;const t=async()=>{const e=await x();s.textContent=e?"üîï Desativar":"üîî Ativar",s.disabled=!1};await t(),s.addEventListener("click",async()=>{s.disabled=!0;try{if(await x()){(await Et({getAuthToken:I})).ok?l("Notifica√ß√µes desativadas.","info"):l("N√£o foi poss√≠vel desativar notifica√ß√µes.","error"),await t();return}const n=await Tt({getAuthToken:I});if(n.ok){l("Notifica√ß√µes ativadas.","success");try{const i=await I(),o=n.subscription?.endpoint;await It({endpoint:o,authToken:i}),l("Envi√°mos uma notifica√ß√£o de teste.","info",3500)}catch(i){console.warn("Test push failed:",i)}}else n.reason==="denied"?l("Notifica√ß√µes recusadas no browser.","warning",3500):String(n.reason||"").includes("VAPID")?l("Push n√£o configurado no servidor (VAPID).","error",4500):n.reason!=="unsupported"&&l("N√£o foi poss√≠vel ativar notifica√ß√µes.","error",3500);await t()}catch(e){console.error("Error in push button handler:",e),l("Erro ao gerir notifica√ß√µes.","error"),await t()}})}async function Wt(){try{window.__pwaOnNewVersion=()=>{l("Nova vers√£o dispon√≠vel. Toque para atualizar.","info",0,!0,{dismissOnClick:!1,onClick:async()=>{await pt()||window.location.reload()}})},await ft()}catch(s){console.error("Failed to initialize SW Registration:",s)}try{await gt()}catch(s){console.error("Failed to initialize Sync Manager:",s)}try{await wt()}catch(s){console.error("Failed to initialize Install Prompt:",s)}try{await yt()}catch(s){console.error("Failed to initialize Install UI:",s)}try{await vt()}catch(s){console.error("Failed to initialize Native Feel:",s)}try{await Bt(()=>import("./theme-toggle-CEDasMo8.js"),[]),console.info("Theme toggle initialized")}catch(s){console.error("Failed to initialize theme toggle:",s),P("Failed to load theme toggle functionality")}try{const s=Y(),t=document.getElementById("loginButton");if(s&&t&&(t.textContent=V(s),t.setAttribute("aria-label",`Conta: ${s}`)),T()){const e=await G();if(e?.theme==="dark"||e?.theme==="light"){const n=document.querySelector("theme-toggle");if(n&&typeof n.setTheme=="function")n.setTheme(e.theme);else{document.body.setAttribute("data-theme",e.theme);try{localStorage.setItem("theme",e.theme)}catch{}}}typeof e?.soundMuted<"u"&&(J(!!e.soundMuted),F(!!e.soundMuted))}}catch(s){console.warn("Could not load user settings from API:",s)}try{X(),Z(),Q(),tt(),et(),nt(),it(),st(),ot(),qt(),N(),window.addEventListener("studystats-updated",N),document.addEventListener("i18n-changed",N),Ht(),console.info("UI utilities initialized")}catch(s){console.error("Failed to initialize UI utilities:",s),P("Failed to initialize drag and navbar functionality")}try{const s=()=>{Object.entries(Ut).forEach(([n,i])=>{const o=document.getElementById(n);if(o&&i!==null&&i!==void 0){const a=o.offsetWidth||400,r=window.innerWidth;let d=r/2+i;const m=10,u=r-a-10;d=Math.max(m,Math.min(d,u)),o.style.left=`${d}px`,o.style.transform="none"}})};s();let t;const e=150;window.addEventListener("resize",()=>{clearTimeout(t),t=setTimeout(s,e)}),console.info("Card positions configured with viewport boundaries")}catch(s){console.error("Failed to configure card positions:",s)}try{const s=new Ct,t=new Ft,e=window.stopwatchInstance=new Dt,n=new xt,i=window.worldClockInstance=new Ot;console.info("All timer features initialized")}catch(s){console.error("Failed to initialize timer features:",s),P("Failed to load timer functionality")}try{const s=()=>{try{window.taskListInstance=new $t}catch(t){console.error("Failed to initialize TaskList:",t)}};"requestIdleCallback"in window?window.requestIdleCallback(s,{timeout:1500}):setTimeout(s,0)}catch(s){console.error("Failed to schedule TaskList init:",s)}try{at(),console.info("üîä Sound manager initialized"),rt(),console.info("üîä Global click sound initialized"),lt();const s="introAutoplayAllowed";let t=!1;const e=()=>{if(t||z())return;const i=new Audio("/sfx/INTRO.mp3");i.volume=.7,i.play().then(()=>{t=!0;try{localStorage.setItem(s,"true")}catch{}}).catch(()=>{})};if(e(),!(()=>{try{return localStorage.getItem(s)==="true"}catch{return!1}})()){const i=()=>{t||e()};document.addEventListener("click",i,{once:!0}),document.addEventListener("keydown",i,{once:!0}),document.addEventListener("touchstart",i,{once:!0})}}catch(s){console.error("Failed to initialize sound manager:",s)}try{const s=document.getElementById("muteToggle");s&&(z()&&F(!0),s.addEventListener("click",async()=>{const t=ct();if(F(t),c("mute_toggle"),l(t?"Som desativado":"Som ativado","info",2e3),T())try{await M({soundMuted:t})}catch{}})),console.info("Mute toggle configured")}catch(s){console.error("Failed to configure mute toggle:",s)}try{g("pomodoroButton","pomodoroCard"),g("timerButton","timerCard"),g("stopwatchButton","stopwatchCard"),g("tasklistButton","tasklistCard"),g("countdownButton","countdownCard"),g("worldClockButton","worldClockCard"),console.info("Toggle buttons configured");const t=new URLSearchParams(window.location.search).get("tool"),n=t&&{pomodoro:"pomodoroButton",timer:"timerButton",stopwatch:"stopwatchButton",tasklist:"tasklistButton",countdown:"countdownButton",worldclock:"worldClockButton"}[t.toLowerCase()];if(n){const i=document.getElementById(n);i&&setTimeout(()=>i.click(),100)}}catch(s){console.error("Failed to configure toggle buttons:",s)}try{let s=null;new MutationObserver(()=>{if(!T())return;const e=document.body.getAttribute("data-theme");e!=="dark"&&e!=="light"||(clearTimeout(s),s=setTimeout(async()=>{try{await M({theme:e})}catch{}},300))}).observe(document.body,{attributes:!0,attributeFilter:["data-theme"]})}catch{}}function N(){dt("sidebarStats")}function Ht(){const s=document.getElementById("sidebarTab"),t=document.getElementById("leftSidebar"),e=document.getElementById("sidebarIndicator");if(!t)return;const n=()=>{const i=document.body.classList.toggle("sidebar-open");s?.setAttribute("aria-expanded",i),s&&(s.textContent=i?"√ó":"‚Ä∫")};s?.addEventListener("click",n),e?.addEventListener("click",i=>{i.stopPropagation(),n()})}function P(s){let t=document.getElementById("error-notification");t||(t=document.createElement("div"),t.id="error-notification",t.setAttribute("role","alert"),t.setAttribute("aria-live","assertive"),t.style.cssText=`
      position: fixed;
      bottom: 20px;
      right: 20px;
      background-color: var(--danger);
      color: white;
      padding: 1rem 1.5rem;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      z-index: 10000;
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.3s ease, transform 0.3s ease;
    `,document.body.appendChild(t)),t.textContent=s,t.style.opacity="1",t.style.transform="translateY(0)",setTimeout(()=>{t.style.opacity="0",t.style.transform="translateY(20px)"},5e3)}function F(s){const t=document.getElementById("muteToggle");if(!t)return;const e=t.querySelector(".mute-icon"),n=t.querySelector(".unmute-icon");s?(e&&(e.style.display="none"),n&&(n.style.display="inline"),t.setAttribute("aria-pressed","true")):(e&&(e.style.display="inline"),n&&(n.style.display="none"),t.setAttribute("aria-pressed","false"))}document.addEventListener("DOMContentLoaded",Wt);
